<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ca" xml:lang="ca" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="exe_highlighter.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>2.3 Obrir automàticament un formulari | Bases de Dades </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="ca" />
<meta name="author" content="Àlvar Serrano Calduch" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" />
<meta name="generator" content="eXeLearning 2.6 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="exe_highlighter.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site" id="exe-node-45"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Omet navegació</a></p>
<div id="header" ><div id="headerContent">Bases de Dades</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Tema 5 (annex): Base avançat</a></li>
   <li><a href="objectius.html" class="no-ch">Objectius</a></li>
   <li><a href="part_i_prctica_inicial.html" class="daddy">Part I: Pràctica inicial</a>
   <ul class="other-section">
      <li><a href="11_taules.html" class="no-ch">1.1 Taules</a></li>
      <li><a href="12_consultes.html" class="no-ch">1.2 Consultes</a></li>
      <li><a href="13_formularis_i_informes.html" class="no-ch">1.3 Formularis i Informes</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="part_ii_macros_voluntari.html" class="current-page-parent daddy">Part II: Macros (Voluntari)</a>
   <ul>
      <li><a href="21_creaci_i_execuci_directa_duna_macro.html" class="no-ch">2.1 Creació i execució directa d'una Macro</a></li>
      <li><a href="22_quan_executar_una_macro_esdeveniments.html" class="no-ch">2.2 Quan executar una macro: esdeveniments</a></li>
      <li id="active"><a href="23_obrir_automticament_un_formulari.html" class="active no-ch">2.3 Obrir automàticament un formulari</a></li>
      <li><a href="24_exemple_avanat_compliment_de_restriccions_externes.html" class="no-ch">2.4 Exemple avançat: compliment de restriccions externes</a></li>
   </ul>
   </li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="22_quan_executar_una_macro_esdeveniments.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="24_exemple_avanat_compliment_de_restriccions_externes.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">2.3 Obrir automàticament un formulari</h1></div>
<div class="iDevice_wrapper textIdevice" id="id93">
<div class="iDevice emphasis0" >
<div id="ta93_113_2" class="block iDevice_content">
<div class="exe-text"><p>Amb la creació del formulari <strong>Menú principal</strong> estem fent una espècie d'aplicació basada en la Base de Dades, de manera que un usuari no expert podria veure i actualitzar la informació a partir dels formularis, i el Mnú principal li permetria navegar per ells.</p>
<p>Per a completar aquesta "aplicació", podríem intentar que en obrir la Base de Dades <strong>Empresa.odb</strong>, automàticament s'obrira el formulari <strong>Menú principal</strong>.</p>
<p>Ho podem aconseguir creant una nova macro per a obrir el formulari <strong>Menú principal</strong>, però no serà tan senzilla com les d'abans, ja quepel moment en què voldrem obrir aquest formulari (al principi, de forma automàtica), ens hem d'assegurar que ja s'ha fet la connexió a aquesta Base de Dades. No podem estar segurs perquè l'estem obrint en aquest moment.</p>
<p>Copieu la següent macro al final del <strong>Module1</strong> de <strong>Empresa.odb</strong>:</p>
<div class="highlighted-code language-java">
<div>
<pre><code>Sub obrirMenuPrincipal
    If  Not Thisdatabasedocument.currentcontroller.isConnected Then Thisdatabasedocument.currentcontroller.connect
    ThisDatabaseDocument.FormDocuments.getbyname("Menú Principal").open
End Sub</code></pre>
</div>
</div>
<p>I ara, per a que s'execute aquesta macro en obrir <strong>Empresa.odb</strong>, hem d'anar a <strong>Eines -&gt; Personalitza -&gt; pestanya Esdeveniments </strong>, i en l'opció <strong>Obre un document</strong> triar la macro <strong>obrirMenuPrincipal</strong> </p>
<p style="text-align: center;"><img src="T5_2_3_1.png" alt="" width="983" height="696" /></p></div>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="22_quan_executar_una_macro_esdeveniments.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="24_exemple_avanat_compliment_de_restriccions_externes.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-nd">
<p><span>Llicenciat sota la </span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/">Llicència Creative Commons Reconeixement NoComercial SenseObraDerivada 2.5</a></p>
</div>
</div>
</div>
</div>
</body></html>