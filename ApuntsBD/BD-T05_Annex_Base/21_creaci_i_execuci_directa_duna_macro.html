<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ca" xml:lang="ca" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>2.1 Creació i execució directa d'una Macro | Bases de Dades </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="ca" />
<meta name="author" content="Àlvar Serrano Calduch" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" />
<meta name="generator" content="eXeLearning 2.6 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site" id="exe-node-10"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Omet navegació</a></p>
<div id="header" ><div id="headerContent">Bases de Dades</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Tema 5 (annex): Base avançat</a></li>
   <li><a href="objectius.html" class="no-ch">Objectius</a></li>
   <li><a href="part_i_prctica_inicial.html" class="daddy">Part I: Pràctica inicial</a>
   <ul class="other-section">
      <li><a href="11_taules.html" class="no-ch">1.1 Taules</a></li>
      <li><a href="12_consultes.html" class="no-ch">1.2 Consultes</a></li>
      <li><a href="13_formularis_i_informes.html" class="no-ch">1.3 Formularis i Informes</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="part_ii_macros_voluntari.html" class="current-page-parent daddy">Part II: Macros (Voluntari)</a>
   <ul>
      <li id="active"><a href="21_creaci_i_execuci_directa_duna_macro.html" class="active no-ch">2.1 Creació i execució directa d'una Macro</a></li>
      <li><a href="22_quan_executar_una_macro_esdeveniments.html" class="no-ch">2.2 Quan executar una macro: esdeveniments</a></li>
      <li><a href="23_obrir_automticament_un_formulari.html" class="no-ch">2.3 Obrir automàticament un formulari</a></li>
      <li><a href="24_exemple_avanat_compliment_de_restriccions_externes.html" class="no-ch">2.4 Exemple avançat: compliment de restriccions externes</a></li>
   </ul>
   </li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="part_ii_macros_voluntari.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="22_quan_executar_una_macro_esdeveniments.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">2.1 Creació i execució directa d'una Macro</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id8">
<div class="iDevice emphasis0">
<div id="ta8_1" class="block iDevice_content">
<p align="justify">La manera inicial de crear una macro serà en el menú  <strong>Eines -&gt; Macros -&gt; Organitza les macros -&gt; Basic<br /></strong></p>
<p style="text-align: center;" align="justify"><img src="T5_2_1_1.png" alt="" width="1016" height="701" /></p>
<p align="justify">(després de la primera vegada podrem anar un poc més directament amb <strong>Eines -&gt; Macros -&gt; Edita les macros </strong>)</p>
<p align="justify">El que se'ns presentarà per a organitzar les macros serà el següent:</p>
<p style="text-align: center;" align="justify"><img src="T5_2_1_2.png" alt="" width="1017" height="702" /></p>
<p style="text-align: justify;" align="justify">Però el lloc on vol col·locar les macros seria un lloc personal (les meves macros). Millor col·locar les macros en la mateixa Base de Dades, que en el nostre exemple és <strong>Empresa.odb</strong>. Així, si copiem la Base de Dades, les macros viatjaran amb ella. Per tant, ens situem en <strong>Empresa.odb</strong> i apretem al botó <strong>Crea</strong>:</p>
<p align="justify"><img src="T5_2_1_3.png" alt="" style="display: block; margin-left: auto; margin-right: auto;" width="1016" height="698" /></p>
<p style="text-align: justify;" align="justify">En preguntarà per un nom de mòdul, on van tots els procediments de les macros. El nom que ens proposa <strong>Module1</strong> ens va bé.</p>
<p style="text-align: justify;" align="justify">Se'ns obrirà una finestra on podem observar que està esperant a que escriguem el codi dels procediments en què consistiran les macros</p>
<p style="text-align: center;" align="justify"><img src="T5_2_1_4.2.png" alt="" width="1158" height="718" /></p>
<p style="text-align: justify;" align="justify">Anem a crear una macro molt senzilleta, per a saludar, escrivint senzillament la sentència <strong>print("Hola")</strong> dins del procediment (<strong>Sub</strong>). Aprofitem per a canviar el nom del procediment a <strong>Saludar</strong> en compte de <strong>Main</strong>, i després apretem el botó de play (o F5) per a executar-la. Així ens quedarà la cosa:</p>
<p style="text-align: center;" align="justify"><img src="T5_2_1_5.png" alt="" width="1142" height="701" /></p>
<p style="text-align: justify;" align="justify"></p>
<p style="text-align: justify;" align="justify">Aquesta macro s'haurà executat de forma directa sense problemes. Però per a poder executar les macros no de forma directa sinó en resposta a un esdeveniment, haurem de baixar la seguretat i permetre l'execució de macros.</p>
<p style="text-align: justify;" align="justify">Es fa en el menú <strong>Eines -&gt; Opcions -&gt; Seguretat -&gt; Seguretat de les macros</strong>, i triar la seguretat més baixa, en la qual sí que permetrem l'execució</p>
<p style="text-align: center;" align="justify"><img src="T5_2_1_6.png" alt="" width="1034" height="702" /></p>
<p style="text-align: justify;" align="justify"></p>
<p align="justify"></p>
</div>
</div>
</div>
<div class="iDevice_wrapper FreeTextIdevice" id="id12">
<div class="iDevice emphasis0">
<div id="ta12_1" class="block iDevice_content">
<p>Ara anem a crear una <strong>Macro</strong>&nbsp;que <strong>no</strong> ser&agrave;<strong> Independent</strong>, sin&oacute; <strong>associada a un objecte</strong>. Ho aprofitarem per veure una manera m&eacute;s r&agrave;pida per fer el proc&eacute;s de creaci&oacute; d'una macro associada a un esdeveniment.</p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="part_ii_macros_voluntari.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="22_quan_executar_una_macro_esdeveniments.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-nd">
<p><span>Llicenciat sota la </span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/">Llicència Creative Commons Reconeixement NoComercial SenseObraDerivada 2.5</a></p>
</div>
</div>
</div>
</div>
</body></html>