<!doctype html>
<html lang="ca">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>4.2.1.2 - Navegació | Bases de Dades </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="Àlvar Serrano Calduch" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site" id="exe-node-56"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Omet navegació</a></p>
<header id="header" ><div id="headerContent">Bases de Dades</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Tema 8: Bases de Dades NoSQL</a></li>
   <li><a href="1__introducci.html" class="no-ch">1 - Introducció</a></li>
   <li><a href="2__bd_clauvalor_redis.html" class="daddy">2 - BD Clau-Valor: Redis</a>
   <ul class="other-section">
      <li><a href="21__installaci_de_redis.html" class="no-ch">2.1 - Instal·lació de Redis</a></li>
      <li><a href="22__entron_grfic_redis_desktop_manager.html" class="no-ch">2.2 - Entron gràfic: Redis Desktop Manager</a></li>
      <li><a href="23__utilitzaci_de_redis.html" class="daddy">2.3 - Utilització de Redis</a>
      <ul class="other-section">
         <li><a href="231__strings.html" class="no-ch">2.3.1 - Strings</a></li>
         <li><a href="232__keys.html" class="no-ch">2.3.2 - Keys</a></li>
         <li><a href="233__hash.html" class="no-ch">2.3.3 - Hash</a></li>
         <li><a href="234__list.html" class="no-ch">2.3.4 - List</a></li>
         <li><a href="235__set.html" class="no-ch">2.3.5 - Set</a></li>
         <li><a href="236__set_ordenat.html" class="no-ch">2.3.6 - Set ordenat</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="3__mongodb.html" class="daddy">3 - MongoDB</a>
   <ul class="other-section">
      <li><a href="31__estructura_json.html" class="no-ch">3.1 - Estructura JSON</a></li>
      <li><a href="32__installaci_de_mongodb.html" class="daddy">3.2 - Instal·lació de MongoDB</a>
      <ul class="other-section">
         <li><a href="321__connexi_al_servidor_de_linstitut.html" class="no-ch">3.2.1 - Connexió al servidor de l'Institut</a></li>
      </ul>
      </li>
      <li><a href="33__utilitzaci_de_mongodb.html" class="daddy">3.3 - Utilització de MongoDB</a>
      <ul class="other-section">
         <li><a href="331__tipus_de_dades.html" class="no-ch">3.3.1 - Tipus de dades</a></li>
         <li><a href="332__operacions_bsiques.html" class="no-ch">3.3.2 - Operacions bàsiques</a></li>
         <li><a href="323__operacions_dactualitzaci_avanada.html" class="daddy">3.2.3 - Operacions d'actualització avançada</a>
         <ul class="other-section">
            <li><a href="3331__set.html" class="no-ch">3.3.3.1 - $set</a></li>
            <li><a href="3332__unset.html" class="no-ch">3.3.3.2 - $unset</a></li>
            <li><a href="3333__rename.html" class="no-ch">3.3.3.3 - $rename</a></li>
            <li><a href="3334__inc.html" class="no-ch">3.3.3.4 - $inc</a></li>
            <li><a href="3335__elements_dun_array.html" class="no-ch">3.3.3.5 - Elements d'un array</a></li>
            <li><a href="3336__inserci_en_arrays_push.html" class="no-ch">3.3.3.6 - Inserció en Arrays: $push</a></li>
            <li><a href="3337__eliminaci_en_arrays_pop_i_pull.html" class="no-ch">3.3.3.7 - Eliminació en arrays: $pop i $pull</a></li>
            <li><a href="3338__upsert.html" class="no-ch">3.3.3.8 - Upsert</a></li>
         </ul>
         </li>
      </ul>
      </li>
      <li><a href="34__consulta_de_documents.html" class="daddy">3.4 - Consulta de documents</a>
      <ul class="other-section">
         <li><a href="341__parmetres_de_les_funcions_find_i_findone.html" class="no-ch">3.4.1 - Paràmetres de les funcions find() i findOne()</a></li>
         <li><a href="342__operadors_de_les_condicions.html" class="no-ch">3.4.2 - Operadors de les condicions</a></li>
         <li><a href="343__agregaci.html" class="no-ch">3.4.3 - Agregació</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="4__bd_xml_existdb.html" class="current-page-parent daddy">4 - BD XML: eXist-db</a>
   <ul>
      <li><a href="41__installaci_dexistdb.html" class="no-ch">4.1 - Instal·lació d'eXist-db</a></li>
      <li class="current-page-parent"><a href="42__llenguatges_de_consultes_xpath_i_xquery.html" class="current-page-parent daddy">4.2 - Llenguatges de consultes XPATH i XQUERY</a>
      <ul>
         <li class="current-page-parent"><a href="421__xpath.html" class="current-page-parent daddy">4.2.1 - XPATH</a>
         <ul>
            <li><a href="4211__vista_darbre.html" class="no-ch">4.2.1.1 - Vista d'arbre</a></li>
            <li id="active"><a href="4212__navegaci.html" class="active no-ch">4.2.1.2 - Navegació</a></li>
            <li><a href="4213__seqncies.html" class="no-ch">4.2.1.3 - Seqüències</a></li>
            <li><a href="4214__funcions.html" class="no-ch">4.2.1.4 - Funcions</a></li>
         </ul>
         </li>
         <li><a href="422__xquery.html" class="daddy">4.2.2 - XQUERY</a>
         <ul class="other-section">
            <li><a href="4221__consultes_xquery.html" class="no-ch">4.2.2.1 - Consultes XQuery</a></li>
            <li><a href="4222__variables.html" class="no-ch">4.2.2.2 - Variables</a></li>
            <li><a href="4223__expressions_avaluables.html" class="no-ch">4.2.2.3 - Expressions avaluables</a></li>
            <li><a href="4224__expressions_flwor.html" class="no-ch">4.2.2.4 - Expressions FLWOR</a></li>
            <li><a href="4225__alternatives.html" class="no-ch">4.2.2.5 - Alternatives</a></li>
            <li><a href="4226__exemple_de_consulta_elaborada.html" class="no-ch">4.2.2.6 - Exemple de consulta "elaborada"</a></li>
            <li><a href="4227__funcions_de_existdb_de_manipulaci_de_bd.html" class="no-ch">4.2.2.7 - Funcions de eXist-db de manipulació de BD</a></li>
         </ul>
         </li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="exercicis.html" class="no-ch">Exercicis</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="4211__vista_darbre.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="4213__seqncies.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">4.2.1.2 - Navegació</h1></header>
<article class="iDevice_wrapper FreeTextIdevice" id="id245">
<div class="iDevice emphasis0">
<div id="ta245_1" class="block iDevice_content">
<p>Com que la representació interna del document <acronym title="Extensible Markup Language">XML</acronym> per XPath serà un arbre, es pot navegar per ell especificant camins d’una manera semblant a com es fa en els directoris dels sistemes operatius.</p>
<p>El més important per tenir en compte a l’hora de crear una expressió XPath és saber quin és el node en el qual està situat el procés (<strong>node de context</strong>), ja que és des d’aquest que s’avaluarà l’expressió. El node de context al principi és el node arrel però es va movent a mesura que es van avaluant les expressions, i per tant podem expressar els camins XPath de dues maneres:</p>
<ul>
<li class="level1">
<div class="li"><strong>Camins absoluts</strong></div>
</li>
<li class="level1">
<div class="li"><strong>Camins relatius</strong></div>
</li>
</ul>
<p>Els <strong>camins absoluts</strong> són camins que sempre comencen en l’arrel de l’arbre. Es poden identificar perquè el primer caràcter de l’expressió sempre serà l’arrel ”<strong>/</strong>”. No importa quin siga el node de context si es fan servir camins absoluts, perquè el resultat sempre serà el mateix.</p>
<p>En canvi, els <strong>camins relatius</strong> parteixen des del node en el qual estem situats.</p>
<p>Per exemple, es pot obtenir el node <b>&lt;nom&gt;</b> del professor de l’exemple anterior fent servir l’expressió XPath següent:</p>
<p class="codi">/classe/professor/nom</p>
<p>Podem veure com s’avalua l’expressió en l’arbre XPath en la següent figura, marcat el camí en taronja:</p>
<p style="text-align: center;"><img src="T6_6_1_2_1.png" style="border: 1px solid black;" width="1000" height="600" /></p>
<p>Observeu que el resultat d’aquesta expressió no és només el contingut de l’element sinó tot l’element <b>&lt;nom&gt;</b>.</p>
<div class="codi2">&lt;nom&gt;Joan&lt;/nom&gt;</div>
<p></p>
<p>Mai no s’ha d’oblidar que l’expressió sempre intenta aconseguir el nombre màxim de camins correctes i, per tant, no necessàriament ha de retornar només un únic valor. Per exemple, si l’expressió per avaluar és la següent:</p>
<p class="codi">/classe/alumnes/alumne/nom</p>
<p>XPath l’avaluaria intentant aconseguir tots els camins que quadren amb l’expressió, tal com podeu veure visualment en la següent figura:</p>
<p style="text-align: center;"><img src="T6_6_1_2_2.png" style="border: 1px solid black;" width="1000" height="600" /></p>
<p>i per tant els resultats són (observeu que Joan es refereix al nom del tercer alumne, no del professor):</p>
<div class="codi2">
<div style="margin-left: 30px;">&lt;nom&gt;Albert&lt;/nom&gt;</div>
<div style="margin-left: 30px;">&lt;nom&gt;Bernat&lt;/nom&gt;</div>
<div style="margin-left: 30px;">&lt;nom&gt;Joan&lt;/nom&gt;</div>
</div>
<p>A pesar que en els exemples anteriors sempre s’han retornat nodes finals això no necessàriament ha de ser així, ja que XPath pot retornar qualsevol tipus d’element com a resultat.</p>
<p class="codi">/classe/alumnes</p>
<p>La navegació per l’arbre no difereix massa dels altres casos:</p>
<p style="text-align: center;"><img src="T6_6_1_2_3.png" style="border: 1px solid black;" width="1000" height="600" /></p>
<p>En aquest cas el resultat no és un element simple sinó que és tot un subarbre d’elements.</p>
<div class="codi2">
<div class="item">
<div class="xml-element" style="margin-left: 30px;"></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">alumnes</span><span>&gt;</span>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">alumne</span> <span class="ace_keyword">aprovat</span>="<span class="ace_string">si</span>"<span>&gt;</span>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">nom</span><span>&gt;</span><span class="ace_identifier">Albert</span><span>&lt;/</span><span class="ace_keyword">nom</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">cognoms</span><span>&gt;</span><span class="ace_identifier">Alegre</span><span>&lt;/</span><span class="ace_keyword">cognoms</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">nota</span><span>&gt;</span><span class="ace_identifier">6</span><span>&lt;/</span><span class="ace_keyword">nota</span><span>&gt;</span></div>
<span>&lt;/</span><span class="ace_keyword">alumne</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">alumne</span> <span class="ace_keyword">aprovat</span>="<span class="ace_string">no</span>"<span>&gt;</span>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">nom</span><span>&gt;</span><span class="ace_identifier">Bernat</span><span>&lt;/</span><span class="ace_keyword">nom</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">cognoms</span><span>&gt;</span><span class="ace_identifier">Balaguer</span><span>&lt;/</span><span class="ace_keyword">cognoms</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">nota</span><span>&gt;</span><span class="ace_identifier">3</span><span>&lt;/</span><span class="ace_keyword">nota</span><span>&gt;</span></div>
<span>&lt;/</span><span class="ace_keyword">alumne</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">alumne</span> <span class="ace_keyword">delegat</span>="<span class="ace_string">si</span>" <span class="ace_keyword">aprovat</span>="<span class="ace_string">si</span>"<span>&gt;</span>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">nom</span><span>&gt;</span><span class="ace_identifier">Joan</span><span>&lt;/</span><span class="ace_keyword">nom</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">cognoms</span><span>&gt;</span><span class="ace_identifier">Centelles</span><span>&lt;/</span><span class="ace_keyword">cognoms</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">nota</span><span>&gt;</span><span class="ace_identifier">8</span><span>&lt;/</span><span class="ace_keyword">nota</span><span>&gt;</span></div>
<span>&lt;/</span><span class="ace_keyword">alumne</span><span>&gt;</span></div>
<span>&lt;/</span><span class="ace_keyword">alumnes</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"></div>
</div>
</div>
<p></p>
<p>Si se sap que una expressió retornarà més d'un resultat però només se’n vol un d’específic, es pot fer servir un número envoltat per claudàtors quadrats ”<strong>[ ]</strong>” per indicar quin és el que es vol aconseguir. Per retornar només el primer alumne podeu fer el següent:</p>
<p class="codi">/classe/alumnes/alumne[1]</p>
<p>que tornarà el següent:</p>
<div class="codi2">
<div style="margin-left: 30px;">&lt;alumne aprovat="si"&gt;</div>
<div style="margin-left: 60px;">&lt;nom&gt;Albert&lt;/nom&gt;</div>
<div style="margin-left: 60px;">&lt;cognoms&gt;Alegre&lt;/cognoms&gt;</div>
<div style="margin-left: 60px;">&lt;nota&gt;6&lt;/nota&gt;</div>
<div style="margin-left: 30px;">&lt;/alumne&gt;</div>
</div>
<p>ja que dels tres nodes disponibles com a fills de <strong>&lt;alumnes&gt;</strong>, només se seleccionarà el primer:</p>
<p style="text-align: center;"><img src="T6_6_1_2_4.png" style="border: 1px solid black;" width="1000" height="600" /></p>
<div><br />
<p>Es poden fer servir els claudàtors en qualsevol lloc de l’expressió per fer determinar quina de les branques es triarà. Per exemple, es pot obtenir només el <b>nom</b> del segon alumne amb una expressió com aquesta:</p>
<pre class="codi">/classe/alumnes/alumne[2]/nom</pre>
<p class="codi2">&lt;nom&gt;Bernat&lt;/nom&gt;</p>
<p></p>
<p>Sempre s’ha d’anar amb compte en escriure les expressions XPath, ja que si el camí especificat no es correspon amb un camí <strong>real</strong> dins de l’arbre no es retornarà cap resultat.</p>
<div class="codi">/classe/nom</div>
<p>Com que en arribar al node <b>classe</b> no n’hi trobarà cap d’anomenat <b>&lt;nom&gt;</b>, no retornarà cap resultat, com podeu veure si seguiu l’arbre:</p>
<p style="text-align: center;"><img src="T6_6_1_2_5.png" style="border: 1px solid black;" width="1000" height="600" /></p>
<p></p>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper FreeTextIdevice" id="id246">
<div class="iDevice emphasis0">
<div id="ta246_85" class="block iDevice_content">
<p class="titolet">Obtenir els atributs d'un element</p>
<p>Els valors dels atributs es poden aconseguir especificant el símbol <strong>@</strong> davant del nom de l'atribut, quan s’haja arribat a l’element que el conté:</p>
<p class="codi">  /classe/professor/@Especialitat</p>
<p style="text-align: center;"> <img src="T6_6_1_2_6.png" style="border: 1px solid black;" width="1000" height="600" /></p>
<p> </p>
<p>S’ha de tenir en compte que a diferència del que passa amb els elements, en obtenir un atribut no tindrem un element sinó només el seu valor: </p>
<div class="codi2"> 507</div>
<p></p>
<div></div>
<div class="nota_blau">
<p> <span style="text-decoration: underline;"><strong>Nota</strong></span></p>
<p>Depenent de l'entorn en què ens trobem, podria ser que l'anterior no ens mostre res. La raó és perquè els atributs no es poden serialitzar, i per tant no es poden mostrar en un entorn de XML. No tindríem aquest problema si accedim des de Java. La manera de solucionar-lo des de l'entorn de eXist és utilitzar la funció <strong> data()</strong>:</p>
<p class="codi">/classe/professor/data(@Especialitat)</p>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper FreeTextIdevice" id="id247">
<div class="iDevice emphasis0">
<div id="ta247_85" class="block iDevice_content">
<p class="titolet">Obtenir el contingut d'un element</p>
<div>
<p>Per a aquells casos en què només vulguem el contingut de l’element, s’ha definit la funció <strong>text()</strong> per obtenir aquest contingut. Això s’ha fet així perquè d’altra manera, com que els nodes de text no tenen nom, no s’hi podria accedir.</p>
<p>De manera que si a un element que tinga contingut de dades se li afegeix <strong><em>text()</em></strong>: </p>
<p class="codi">  /classe/professor/nom/text()</p>
<p>…retornarà el contingut del node sense les etiquetes: </p>
<div class="codi2">  Joan</div>
<p> </p>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper FreeTextIdevice" id="id248">
<div class="iDevice emphasis0">
<div id="ta248_85" class="block iDevice_content">
<p class="titolet">Comodins</p>
<p>De la mateixa manera que en els sistemes operatius, es poden fer servir comodins diversos en les expressions XPath. Es poden veure els comodins en la taula següent.</p>
<table border="1">
<tbody>
<tr class="row0 borderth"><th class="col0">Comodí</th><th class="col1 leftalign">Significat</th></tr>
<tr class="row1">
<td class="col0 leftalign">*</td>
<td class="col1">L’asterisc es fa servir per indicar tots els elements d’un determinat nivell.</td>
</tr>
<tr class="row2">
<td class="col0 leftalign">.</td>
<td class="col1 leftalign">Com en els directoris dels sistemes operatius el punt serveix per indicar el node actual.</td>
</tr>
<tr class="row3">
<td class="col0 leftalign">..</td>
<td class="col1 leftalign">Es fa servir per indicar el pare del node en el qual estem.</td>
</tr>
<tr class="row4">
<td class="col0 leftalign">//</td>
<td class="col1 leftalign">La doble barra indica que quadrarà amb qualsevol cosa des del node en el qual estem, es a dir que buscarà en tots els seus descendents. Pot ser un sol element o un arbre de nodes.</td>
</tr>
</tbody>
</table>
<p>Amb l’asterisc es poden obtenir tots els elements d’un determinat nivell. Amb aquesta expressió es poden obtenir tots els elements de dins del node <strong>professor</strong>.</p>
<p class="codi">/classe/professor/*</p>
<p>Aquesta expressió retornarà per separat els dos nodes fills de <strong>&lt;professor&gt;</strong> ,<strong> &lt;nom&gt;</strong> i<strong> &lt;cognom&gt;.</strong></p>
<div class="codi2">
<div style="margin-left: 30px;">&lt;nom&gt;Joan&lt;/nom&gt;</div>
<div style="margin-left: 30px;">&lt;cognoms&gt;Puig&lt;/cognoms&gt;</div>
</div>
<p>O bé fer servir les dobles barres (<strong>//</strong>) per obtenir tots els elements <b>&lt;nom&gt;</b> del fitxer independentment del lloc on estiguen dins del document XML.</p>
<p class="codi">//nom</p>
<p>El resultat serà:</p>
<div class="codi2">
<div style="margin-left: 30px;">&lt;nom&gt;Joan&lt;/nom&gt;</div>
<div style="margin-left: 30px;">&lt;nom&gt;Albert&lt;/nom&gt;</div>
<div style="margin-left: 30px;">&lt;nom&gt;Bernat&lt;/nom&gt;</div>
<div style="margin-left: 30px;">&lt;nom&gt;Joan&lt;/nom&gt;</div>
</div>
<p>Observeu que apareix el nom Joan 2 vegades, ja que és tant el nom del professor com d'un dels alumnes</p>
<div class="nota_blau">
<p><span style="text-decoration: underline;"><strong>Nota</strong></span></p>
<p>En realitat aquesta sentència XPath tornarà molts més resultats, ja que buscarà en tots els documents de la col·lecció, i en <strong>Rutes.xml</strong> hi ha molts elements <strong>nom</strong>: els noms de les rutes i els noms dels punts, a banda dels noms de professors i d'alumnes.</p>
</div>
<p>Es poden posar les dobles barres en qualsevol lloc dins de l’expressió per indicar que pot haver qualsevol cosa enmig a partir del lloc on apareguen.</p>
<p class="codi">/classe/alumnes//nom</p>
<p>Donarà els dos noms dels alumnes (ara sí només alumnes, ni professors ni noms de ruta ni de punts):</p>
<div class="codi2">
<div style="margin-left: 30px;">&lt;nom&gt;Albert&lt;/nom&gt;</div>
<div style="margin-left: 30px;">&lt;nom&gt;Bernat&lt;/nom&gt;</div>
<div style="margin-left: 30px;">&lt;nom&gt;Joan&lt;/nom&gt;</div>
</div>
<p>Tot i que facilita molt la creació d’expressions no és molt recomanable abusar del comodí<strong> //</strong> per motius d’eficiència. Les expressions amb aquest comodí requeriran molts més càlculs per ser avaluades, i per tant les expressions tardaran més a donar resultats. </p>
<p> </p>
</div>
</div>
</article>
<article class="iDevice_wrapper FreeTextIdevice" id="id249">
<div class="iDevice emphasis0">
<div id="ta249_85" class="block iDevice_content">
<p class="titolet">Eixos XPATH</p>
<p>Per avaluar les expressions XPath s’explora un arbre, de manera que també es proporcionen una sèrie d’elements per fer referència a parts de l’arbre. Aquestos elements s’anomenen <strong>eixos XPath</strong></p>
<table border="1">
<tbody>
<tr class="row0 borderth"><th class="col0 leftalign">Eix</th><th class="col1 leftalign">Significat</th></tr>
<tr class="row1">
<td class="col0 leftalign"><strong>self::</strong></td>
<td class="col1 leftalign">El node en el qual està el procés (fa el mateix que el punt)</td>
</tr>
<tr class="row2">
<td class="col0 leftalign"><strong>child::</strong></td>
<td class="col1 leftalign">Fill de l’element actual</td>
</tr>
<tr class="row3">
<td class="col0 leftalign"><strong>parent::</strong></td>
<td class="col1 leftalign">El pare de l’element actual (idèntic a fer servir <code>..</code>)</td>
</tr>
<tr class="row4">
<td class="col0"><strong>attribute::</strong></td>
<td class="col1">Es fa servir per obtenir un atribut de l’element actual (@)</td>
</tr>
</tbody>
</table>
<p>Alguns d’aquestos eixos pràcticament no es fan servir perquè generalment és més còmode i curt definir les expressions a partir del símbol. Tothom prefereix fer servir una expressió com aquesta:</p>
<div class="codi">
<div>/classe/professor/nom</div>
</div>
<p>Que no la seua versió equivalent fent servir els eixos:</p>
<div class="codi">
<div>/child::classe/child::professor/child::nom</div>
</div>
<p>A part dels vistos en la taula anterior n’hi ha d’altres, que en aquest cas no tenen cap símbol que els simplifique:</p>
<table border="1">
<tbody>
<tr class="row0 borderth"><th class="col0 leftalign">Eix</th><th class="col1 leftalign">Significat</th></tr>
<tr class="row1">
<td class="col0 leftalign"><strong>descendant::</strong></td>
<td class="col1 leftalign">Tots els descendents del node actual</td>
</tr>
<tr class="row2">
<td class="col0"><strong>desdendant-or-self::</strong></td>
<td class="col1 leftalign">El node actual i els seus descendents</td>
</tr>
<tr class="row3">
<td class="col0 leftalign"><strong>ancestor::</strong></td>
<td class="col1 leftalign">Els ascendents del node</td>
</tr>
<tr class="row4">
<td class="col0 leftalign"><strong>ancestor-or-self::</strong></td>
<td class="col1 leftalign">El node actual i els seus ascendents</td>
</tr>
<tr class="row5">
<td class="col0 leftalign"><strong>preceding::</strong></td>
<td class="col1">Tots els elements precedents al node actual</td>
</tr>
<tr class="row6">
<td class="col0 leftalign"><strong>preceding-sibling::</strong></td>
<td class="col1 leftalign">Tots els germans precedents</td>
</tr>
<tr class="row7">
<td class="col0 leftalign"><strong>following::</strong></td>
<td class="col1 leftalign">Elements que segueixen el node actual</td>
</tr>
<tr class="row8">
<td class="col0 leftalign"><strong>following-sibling::</strong></td>
<td class="col1 leftalign">Germans posteriors al node actual</td>
</tr>
<tr class="row9">
<td class="col0 leftalign"><strong>namespace::</strong></td>
<td class="col1 leftalign">Conté l’espai de noms del node actual</td>
</tr>
</tbody>
</table>
</div>
</div>
</article>
<article class="iDevice_wrapper FreeTextIdevice" id="id250">
<div class="iDevice emphasis0">
<div id="ta250_85" class="block iDevice_content">
<p class="titolet">Condicions</p>
<p>Un apartat interessant de les expressions XPath és poder afegir condicions per a la selecció de nodes. A qualsevol expressió XPath se li poden afegir condicions per obtenir només els nodes que complesquen la condició especificada.</p>
<p>Per exemple, aquesta expressió selecciona només els professors que tinguen un element <b>&lt;nom&gt;</b> com a fill de <b>&lt;professor&gt;</b>:</p>
<div class="codi">
<div>/classe/professor[nom]</div>
</div>
<p>Si s’aplica l’expressió a l’exemple que hem fet servir per fer la vista d’arbre, el resultat serà el node <b>&lt;professor&gt;</b> que té dins seu <b>&lt;nom&gt;</b> (i ens apareixerà l'únic professor que tenim, ja que sí que té un fill nom)</p>
<div class="codi2">
<div> </div>
<div class="item">
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">professor</span> <span class="ace_keyword">Especialitat</span>="<span class="ace_string">507</span>"<span>&gt;</span>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">nom</span><span>&gt;</span><span class="ace_identifier">Joan</span><span>&lt;/</span><span class="ace_keyword">nom</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">cognoms</span><span>&gt;</span><span class="ace_identifier">Puig</span><span>&lt;/</span><span class="ace_keyword">cognoms</span><span>&gt;</span></div>
<span>&lt;/</span><span class="ace_keyword">professor</span><span>&gt;</span></div>
</div>
</div>
<p>En el valor de l’expressió s’hi especifiquen camins relatius des del node que tinga la condició. Fent servir condicions es pot fer una expressió que només retorne el professor si té alumnes (i ens tornaria el mateix resultat que abans, ja que sí que té alumnes)</p>
<div class="codi">
<div>/classe/professor[../alumnes/alumne]</div>
</div>
<p> </p>
<p>Normalment la complexitat de les condicions va més enllà de comprovar si el node existeix, i es fan servir per comprovar si un node té un valor determinat. Per exemple, per obtenir els alumnes que es diguen “Bernat”:</p>
<div class="codi">
<div>/classe/alumnes/alumne[nom="Bernat"]</div>
</div>
<p>que donarà:</p>
<p class="codi2">  &lt;alumne aprovat="no"&gt;<br />    &lt;nom&gt;Bernat&lt;/nom&gt;<br />    &lt;cognoms&gt;Balaguer&lt;/cognoms&gt;<br />    &lt;nota&gt;3&lt;/nota&gt;<br />  &lt;/alumne&gt;</p>
<p>Les condicions es poden posar en qualsevol lloc del camí i n’hi pot haver tantes com calga. Per obtenir el cognom del professor que es diu “Bernat” es pot fer servir una expressió com aquesta.</p>
<div class="codi">
<div>/classe//alumne[nom="Bernat"]/cognoms</div>
</div>
<p>Que donarà de resultat:</p>
<div class="codi2">
<div>  &lt;cognoms&gt;Balaguer&lt;/cognoms&gt;</div>
</div>
<p> </p>
<p>De la mateixa manera que per obtenir-ne els valors, es poden fer comparacions amb els valors dels atributs especificant el seu nom després del símbol <b>@</b>. Per saber si un element té l’atribut ‘delegat’:</p>
<div class="codi">
<div>/classe//alumne[@delegat]</div>
</div>
<p>Retornarà:</p>
<div class="codi2">
<div> </div>
<div class="item">
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">alumne</span> <span class="ace_keyword">delegat</span>="<span class="ace_string">si</span>" <span class="ace_keyword">aprovat</span>="<span class="ace_string">si</span>"<span>&gt;</span>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">nom</span><span>&gt;</span><span class="ace_identifier">Joan</span><span>&lt;/</span><span class="ace_keyword">nom</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">cognoms</span><span>&gt;</span><span class="ace_identifier">Centelles</span><span>&lt;/</span><span class="ace_keyword">cognoms</span><span>&gt;</span></div>
<div class="xml-element" style="margin-left: 30px;"><span>&lt;</span><span class="ace_keyword">nota</span><span>&gt;</span><span class="ace_identifier">8</span><span>&lt;/</span><span class="ace_keyword">nota</span><span>&gt;</span></div>
<span>&lt;/</span><span class="ace_keyword">alumne</span><span>&gt;</span></div>
</div>
<div></div>
</div>
<p>mentre que en la mateixa sentència ens haguérem preguntat per l'atribut aprovat, ens apareixerien els 3 alumnes, ja que tots tres el tenen.</p>
<p>De la mateixa manera que amb els elements, es poden posar condicions als atributs per saber si el seu valor té un determinat valor, etc.</p>
<div class="codi">
<div>/classe//alumne[@aprovat="si"]</div>
</div>
<p>que ens donaria els dos alumnes que estan aprovats</p>
<div class="codi2">
<div style="margin-left: 30px;">&lt;alumne aprovat="si"&gt;<br />   &lt;nom&gt;Albert&lt;/nom&gt;<br />   &lt;cognoms&gt;Alegre&lt;/cognoms&gt;<br />   &lt;nota&gt;6&lt;/nota&gt;<br />&lt;/alumne&gt;<br />&lt;alumne delegat="si" aprovat="si"&gt;<br />   &lt;nom&gt;Joan&lt;/nom&gt;<br />   &lt;cognoms&gt;Centelles&lt;/cognoms&gt;<br />   &lt;nota&gt;8&lt;/nota&gt;<br />&lt;/alumne&gt;</div>
</div>
<p>Les condicions també poden ser de desigualtat:</p>
<div class="codi">
<div>/classe/professor[@Especialitat&gt;=507]</div>
</div>
<p>La funció <strong>not()</strong> es fa servir per negar les condicions:</p>
<div class="codi">
<div>/classe//alumne[not(@delegat)]</div>
</div>
<p class="codi2">  &lt;alumne aprovat="si"&gt;<br />    &lt;nom&gt;Albert&lt;/nom&gt;<br />    &lt;cognoms&gt;Alegre&lt;/cognoms&gt;<br />    &lt;nota&gt;6&lt;/nota&gt;<br />  &lt;/alumne&gt;<br />  &lt;alumne aprovat="no"&gt;<br />    &lt;nom&gt;Bernat&lt;/nom&gt;<br />    &lt;cognoms&gt;Balaguer&lt;/cognoms&gt;<br />    &lt;nota&gt;3&lt;/nota&gt;<br />  &lt;/alumne&gt;</p>
<p>Es poden mesclar les expressions amb condicions sobre atributs i sobre elements per aconseguir expressions més complexes especificant-les una al costat de l’altra. Per exemple, podem obtenir l'alumne que té no té l’atribut delegat i que està aprovat:</p>
<div class="codi">
<div>/classe//alumne[@delegat][@aprovat="si"]</div>
</div>
<p class="codi2">  &lt;alumne delegat="si" aprovat="si"&gt;<br />    &lt;nom&gt;Joan&lt;/nom&gt;<br />    &lt;cognoms&gt;Centelles&lt;/cognoms&gt;<br />    &lt;nota&gt;8&lt;/nota&gt;<br />  &lt;/alumne&gt;</p>
<p>L’expressió pot ser tan complexa com calga. Per exemple es pot obtenir la llista dels cognoms dels alumnes del professor de l'especialitat “507” que es diu “Joan”:</p>
<div class="codi">
<div>/classe/professor[@Especialitat="507"][nom="Joan"]/../alumnes/alumne/cognoms</div>
</div>
<p>Que retornarà els tres cognoms dels alumnes:</p>
<div class="codi2">
<div> </div>
<div style="margin-left: 30px;">&lt;cognoms&gt;Alegre&lt;/cognoms&gt;</div>
<div style="margin-left: 30px;">&lt;cognoms&gt;Balaguer&lt;/cognoms&gt;</div>
<div style="margin-left: 30px;">&lt;cognoms&gt;Centelles&lt;/cognoms&gt;</div>
<div> </div>
</div>
<p> </p>
</div>
</div>
</article>
<article class="iDevice_wrapper FreeTextIdevice" id="id251">
<div class="iDevice emphasis0">
<div id="ta251_1" class="block iDevice_content">
<p class="titolet">Documents</p>
<p>Si no especifiquem res, a banda de la ruta, <strong>eXist</strong> buscarà en <strong>tots</strong> els documents de la col·lecció en la qual estiguem situats.</p>
<p>Per a buscar únicament en un document, l'haurem d'especificar al principi de la ruta. I la manera d'especificar el document serà: <strong>doc(<em>ruta_del_document</em>)</strong>. Si posem únicament el nom del document no el trobarà, i estarem obligats a posar tota la seua ruta que serà: <strong>/db/nom_col/nom_doc</strong><em> </em>. És a dir, el següent no troba res:</p>
<div class="codi2">
<div><span style="color: #ff0000;">doc("classe.xml")</span></div>
</div>
<p> La manera d'accedir serà:</p>
<div class="codi2">doc("db/Tema9/classe.xml")</div>
<p>En altres entorns potser sí que funcione posar únicament el nom del document, però en el que estem treballant nosaltres, haurem de posar tota la ruta del document en la Base de Dades. </p>
<p>D'aquesta manera podrem solucionar el problema de la següent sentència, que agafa tots els noms d'alumnes i de professors, però també de rutes i de punts:</p>
<p class="codi">//nom</p>
<p>que donarà un total de 32 resultats</p>
<p>Si només els volem d'un document:</p>
<p class="codi">doc("db/Tema9/classe.xml")//nom</p>
<p class="codi2">&lt;nom&gt;Joan&lt;/nom&gt;<br />&lt;nom&gt;Albert&lt;/nom&gt;<br />&lt;nom&gt;Bernat&lt;/nom&gt;<br />&lt;nom&gt;Joan&lt;/nom&gt;</p>
<p></p>
</div>
</div>
</article>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="4211__vista_darbre.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="4213__seqncies.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</nav>
</div>
</section>
</div>
</div>
</body></html>