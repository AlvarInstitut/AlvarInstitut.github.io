<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ca" xml:lang="ca" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>16. El predicat DISTINCT | Bases de Dades </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="ca" />
<meta name="author" content="Àlvar Serrano Calduch" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" />
<meta name="generator" content="eXeLearning 2.6 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site" id="exe-node-11"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Omet navegació</a></p>
<div id="header" ><div id="headerContent">Bases de Dades</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Tema 6: SQL -  Consulta bàsica (part I)</a></li>
   <li><a href="objectius_i_coneixements_previs.html" class="no-ch">Objectius i Coneixements previs</a></li>
   <li><a href="1_introducci.html" class="no-ch">1. Introducció</a></li>
   <li><a href="2_ddl_i_dml.html" class="no-ch">2. DDL i DML</a></li>
   <li><a href="3_client_dbeaver_installaci_i_confiuraci.html" class="no-ch">3. Client DBeaver: instal·lació i confiuració</a></li>
   <li><a href="4_client_dbeaver_utilitzaci.html" class="no-ch">4. Client DBeaver: utilització</a></li>
   <li><a href="5_dades_dels_exemples_i_els_exercicis.html" class="no-ch">5. Dades dels exemples i els exercicis</a></li>
   <li><a href="6_operadors.html" class="no-ch">6. Operadors</a></li>
   <li><a href="7_funcions.html" class="daddy">7. Funcions</a>
   <ul class="other-section">
      <li><a href="71_formats_de_les_dates.html" class="no-ch">7.1 Formats de les dates</a></li>
      <li><a href="72_formats_dels_nmeros.html" class="no-ch">7.2 Formats dels números</a></li>
   </ul>
   </li>
   <li><a href="8_la_consulta_select.html" class="no-ch">8. La consulta SELECT</a></li>
   <li><a href="9_consulta_bsica.html" class="daddy">9. Consulta bàsica</a>
   <ul class="other-section">
      <li><a href="exercicis.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="10_lies_en_les_columnes.html" class="daddy">10. Àlies en les columnes</a>
   <ul class="other-section">
      <li><a href="exercicis0.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="11_la_clusula_where.html" class="daddy">11. La clàusula WHERE</a>
   <ul class="other-section">
      <li><a href="exercicis1.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="12_funcions_dagregat.html" class="daddy">12. Funcions d'agregat</a>
   <ul class="other-section">
      <li><a href="exercicis2.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="13_la_clusula_group_by.html" class="daddy">13. La clàusula GROUP BY</a>
   <ul class="other-section">
      <li><a href="exercicis3.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="14_la_clusula_having.html" class="daddy">14. La clàusula HAVING</a>
   <ul class="other-section">
      <li><a href="exercicis4.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="15_la_clusula_order_by.html" class="daddy">15. La clàusula ORDER BY</a>
   <ul class="other-section">
      <li><a href="exercicis5.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li id="active"><a href="16_el_predicat_distinct.html" class="active daddy">16. El predicat DISTINCT</a>
   <ul>
      <li><a href="exercicis6.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="17_la_clusula_limit__offset.html" class="daddy">17. La clàusula LIMIT .. OFFSET</a>
   <ul class="other-section">
      <li><a href="exercicis7.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="18_consulta_de_creaci_de_taules.html" class="daddy">18. Consulta de creació de taules</a>
   <ul class="other-section">
      <li><a href="exercicis8.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="19_ordre_amb_qu_sexecuta_una_sentncia_sql.html" class="no-ch">19. Ordre amb què s'executa una sentència SQL</a></li>
   <li><a href="exercicis_de_tot_el_tema_amb_els_resultats.html" class="no-ch">Exercicis de tot el tema, amb els resultats</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="exercicis5.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="exercicis6.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">16. El predicat DISTINCT</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id11">
<div class="iDevice emphasis0">
<div id="ta11_1" class="block iDevice_content">
<p> </p>
<p>Per defecte, si no especifiquem el contrari, eixiran <i>totes</i> les files de la taula o taules que acomplesquen les condicions. Així, per exemple, si de la taula d'instituts volguérem treure únicament el codi de la població, ens eixiria per exemple 12040 (el codi de Castelló) en tantes files com instituts de Castelló tinguem (concretament 14). És el mateix resultat que si haguérem posat el predicat <b>ALL</b> davant de les columnes, ja que aquest és el predicat per defecte:</p>
<div class="codiSQL">SELECT ALL cod_m<br />FROM INSTITUTS</div>
<p>Aquest resultat no és el correcte, si volem consultes com "Poblacions on hi ha instituts". Seria millor si isquera 12040 només una vegada. Açò ho aconseguirem amb el predicat DISTINCT.</p>
<p>En definitiva el que farà el predicat DISTINCT serà traure les files diferents del resultat que demanem. Si només demanem un camp, traurà els valors diferents d'aquest camp. Si demanem més d'un camp, traurà els valors diferents per al conjunt dels camps (és a dir les files diferents, que en un camp poden coincidir, però no en el conjunt de tots els camps)</p>
<p></p>
<p class="titolet">Sintaxi</p>
<div class="codiSQL">SELECT DISTINCT &lt;columnes &gt; <br />
<blockquote>FROM &lt;taules&gt;</blockquote>
</div>
<p> </p>
<p>Així, en l'exemple anterior:</p>
<div class="codiSQL">SELECT DISTINCT cod_m<br />FROM INSTITUTS</div>
<p></p>
<p>Hi ha una variant del DISTINCT que suporta PostgreSQL, però que no suporten altres SGBD més senzills, com Access o LibreOffice Base. És posar el DISTINCT dins d'una funció d'agregat, com per exemple COUNT. El resultat és que comptarà (o la funció implicada: sumarà calcularà la mitjana, ...) els valors diferents del camp que vaja a continuació.</p>
<p>Així per exemple, si volem comptar en quantes poblacions diferents tenim instituts, la consulta és tan senzilla com aquesta:</p>
<p class="codiSQL">SELECT COUNT(DISTINCT cod_m)<br />FROM INSTITUTS</p>
</div>
</div>
</div>
<div class="iDevice_wrapper FreeTextIdevice" id="id39">
<div class="iDevice emphasis0">
<div id="ta39_1" class="block iDevice_content">
<p class="titolet">Exemples</p>
<ol>
<li value="1">
<p>Traure les diferents provincies.</p>
</li>
</ol>
<p class="codiSQL">SELECT DISTINCT provincia<br />FROM COMARQUES</p>
<ol start="2">
<li>
<p>Traure els distints districtes (codis postals) de Castelló (codi de municipi 12040) on hi ha instituts</p>
</li>
</ol>
<p class="codiSQL">SELECT DISTINCT codpostal<br />FROM INSTITUTS<br />WHERE cod_m=12040</p>
<ol start="3">
<li>
<p>Traure les distintes comarques i llengües que es parlen en elles</p>
</li>
</ol>
<p class="codiSQL">SELECT DISTINCT nom_c , llengua<br />FROM POBLACIONS<br />ORDER BY 1</p>
<blockquote>
<p></p>
</blockquote>
<p> </p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="exercicis5.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="exercicis6.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Llicenciat sota la </span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Llicència Creative Commons Reconeixement NoComercial CompartirIgual 3.0</a></p>
</div>
</div>
</div>
</div>
</body></html>