<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ca" xml:lang="ca" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Exercicis de tot el tema, amb els resultats | Bases de Dades </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="ca" />
<meta name="author" content="Àlvar Serrano Calduch" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site" id="exe-node-98"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Omet navegació</a></p>
<div id="header" ><div id="headerContent">Bases de Dades</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Tema 6: SQL -  Consulta bàsica (part I)</a></li>
   <li><a href="objectius_i_coneixements_previs.html" class="no-ch">Objectius i Coneixements previs</a></li>
   <li><a href="1_introducci.html" class="no-ch">1. Introducció</a></li>
   <li><a href="2_ddl_i_dml.html" class="no-ch">2. DDL i DML</a></li>
   <li><a href="3_client_dbeaver_installaci_i_confiuraci.html" class="no-ch">3. Client DBeaver: instal·lació i confiuració</a></li>
   <li><a href="4_client_dbeaver_utilitzaci.html" class="no-ch">4. Client DBeaver: utilització</a></li>
   <li><a href="5_dades_dels_exemples_i_els_exercicis.html" class="no-ch">5. Dades dels exemples i els exercicis</a></li>
   <li><a href="6_operadors.html" class="no-ch">6. Operadors</a></li>
   <li><a href="7_funcions.html" class="daddy">7. Funcions</a>
   <ul class="other-section">
      <li><a href="71_formats_de_les_dates.html" class="no-ch">7.1 Formats de les dates</a></li>
      <li><a href="72_formats_dels_nmeros.html" class="no-ch">7.2 Formats dels números</a></li>
   </ul>
   </li>
   <li><a href="8_la_consulta_select.html" class="no-ch">8. La consulta SELECT</a></li>
   <li><a href="9_consulta_bsica.html" class="daddy">9. Consulta bàsica</a>
   <ul class="other-section">
      <li><a href="exercicis.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="10_lies_en_les_columnes.html" class="daddy">10. Àlies en les columnes</a>
   <ul class="other-section">
      <li><a href="exercicis0.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="11_la_clusula_where.html" class="daddy">11. La clàusula WHERE</a>
   <ul class="other-section">
      <li><a href="exercicis1.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="12_funcions_dagregat.html" class="daddy">12. Funcions d'agregat</a>
   <ul class="other-section">
      <li><a href="exercicis2.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="13_la_clusula_group_by.html" class="daddy">13. La clàusula GROUP BY</a>
   <ul class="other-section">
      <li><a href="exercicis3.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="14_la_clusula_having.html" class="daddy">14. La clàusula HAVING</a>
   <ul class="other-section">
      <li><a href="exercicis4.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="15_la_clusula_order_by.html" class="daddy">15. La clàusula ORDER BY</a>
   <ul class="other-section">
      <li><a href="exercicis5.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="16_el_predicat_distinct.html" class="daddy">16. El predicat DISTINCT</a>
   <ul class="other-section">
      <li><a href="exercicis6.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="17_la_clusula_limit__offset.html" class="daddy">17. La clàusula LIMIT .. OFFSET</a>
   <ul class="other-section">
      <li><a href="exercicis7.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="18_consulta_de_creaci_de_taules.html" class="daddy">18. Consulta de creació de taules</a>
   <ul class="other-section">
      <li><a href="exercicis8.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="19_ordre_amb_qu_sexecuta_una_sentncia_sql.html" class="no-ch">19. Ordre amb què s'executa una sentència SQL</a></li>
   <li id="active"><a href="exercicis_de_tot_el_tema_amb_els_resultats.html" class="active no-ch">Exercicis de tot el tema, amb els resultats</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="19_ordre_amb_qu_sexecuta_una_sentncia_sql.html" class="prev"><span><span>&laquo; </span>Anterior</span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">Exercicis de tot el tema, amb els resultats</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id48">
<div class="iDevice emphasis0">
<div id="ta48_85" class="block iDevice_content">
<p>En la BD <strong>factura</strong>, connectant com a usuari <strong>factura</strong>:</p>
<p><b>6.1 </b>Traure tota la informació dels pobles (anomeneu-la <b>Ex_6_1.sql</b>).</p>
<p style="text-align: center;"><img style="border: 1px solid black;" src="Ex_6_1.png" height="277" width="414" /></p>
<p style="text-align: center;">Un total de <strong>1663 files</strong></p>
<p><b>6.2 </b>Traure el codi postal, el nom i l'adreça, per aquest ordre, de tots els venedors (anomeneu-la <b>Ex_6_2.sql</b>).</p>
<p style="text-align: center;"><img style="border: 1px solid black;" src="Ex_6_2.png" height="289" width="730" /></p>
<p><b>6.3 </b>Traure el codi d'article, la descripció, preu i preu incrementat en un 5%, de tots els articles.</p>
<p style="text-align: center;"><img style="border: 1px solid black;" src="Ex_6_3.png" height="302" width="554" /></p>
<p style="text-align: center;">Un total de <strong>812 files</strong></p>
<p><b>6.4</b> Traure la informació dels clients amb el següent format (ha d'anar tot en una columna):</p>
<p style="margin-left: 30px;"><strong>Damborenea Corbato, Alicia. CALLE MADRID, 83 (12425)</strong></p>
<p style="margin-left: 30px;">Fixeu-vos que està tot en una columna, i per tant haureu de concatenar de la forma adequada. Fixeu-vos també que en en el nom només les inicials estan en majúscules</p>
<p style="margin-left: 30px; text-align: center;"><img style="border: 1px solid black;" src="Ex_6_4.png" /></p>
<p style="margin-left: 30px; text-align: center;">Un total de <strong>49 files</strong></p>
<p><b>6.5</b> Traure el num_f, data i cod_ven de les factures amb les següents capçaleres respectivament: <b>Número Factura</b>, <b>data</b> i <b>Codi Venedor</b> (anomeneu-lo <b>Ex_6_5</b>)</p>
<p style="text-align: center;"><img src="Ex_6_5.png" style="border: 1px solid black;" height="302" width="400" /></p>
<p style="text-align: center;">Un total de <strong>105 files</strong></p>
<p><b>6.6 </b>Donar àlias als camps que ho necessiten de la taula ARTICLE (anomeneu-lo <b>Ex_6_6</b>)</p>
<p style="text-align: center;"><img src="Ex_6_6.png" style="border: 1px solid black;" height="304" width="1046" /></p>
<p style="text-align: center;">Un total de <strong>812 files</strong></p>
<p><b>6.7 </b>Traure els <strong>clients</strong> de la <strong>ciutat</strong> amb codi <strong>12309</strong>.</p>
<p style="text-align: center;"><img src="Ex_6_7.png" style="border: 1px solid black;" height="266" width="918" /></p>
<p><b>6.8 </b>Traure totes les <strong>factures</strong> del mes de <strong>març</strong> de <strong>2015</strong>.</p>
<p style="text-align: center;"><img src="Ex_6_8.png" style="border: 1px solid black;" /></p>
<p><b>6.9 </b>Traure tots els articles de la <strong>categoria</strong> <strong>BjcOlimpia</strong> amb un <strong>stock</strong> entre<strong> 2</strong> i <strong>7</strong> unitats.</p>
<p style="text-align: center;"><img style="border: 1px solid black;" src="Ex_6_9.png" height="237" width="966" /></p>
<p><b>6.10</b> Traure tots els <strong>clients</strong> que <strong>no</strong> tenen introduït el <strong>codi postal</strong>.<b><br /></b></p>
<p style="text-align: center;"><img src="Ex_6_10.png" style="border: 1px solid black;" height="239" width="966" /></p>
<p><b>6.11 </b>Traure tots els <strong>articles</strong> amb el <strong>stock</strong> introduït però que <strong>no</strong> tenen introduït el <strong>stock mínim</strong>.</p>
<p style="text-align: center;"><img src="Ex_6_11.png" style="border: 1px solid black;" height="238" width="947" /></p>
<p><b>6.12 </b>Traure tots els <strong>clients</strong>, el<strong> primer cognom</strong> dels quals és <strong>VILLALONGA</strong>.</p>
<p style="text-align: center;"><img src="Ex_6_12.png" style="border: 1px solid black;" height="93" width="972" /></p>
<p><b>6.13.a </b>Modificar l'anterior per a traure tots els que són <strong>VILLALONGA</strong> de <strong>primer</strong> o de <strong>segon</strong> cognom.</p>
<p style="text-align: center;"><b><img src="Ex_6_13_a.png" style="border: 1px solid black;" height="116" width="974" /></b></p>
<p style="text-align: left;"><b>6.13.b </b>Modificar l'anterior per a traure tots els que <strong>no</strong> són <strong>VILLALONGA</strong> ni de primer ni de segon cognom.</p>
<p style="text-align: center;"><img src="Ex_6_13_b.png" style="border: 1px solid black;" /></p>
<p style="text-align: center;">Un total de <strong>46 files</strong></p>
<p><strong>6.14</strong> Traure els <strong>articles</strong> "<strong>Pulsador</strong>" (la descripció conté aquesta paraula), el <strong>preu</strong> dels quals oscila entre<strong> 2 i 4 €</strong> i dels quals tenim un <strong>stock</strong> estrictament <strong>major</strong> que el <strong>stock mínim</strong>.<strong><br /></strong></p>
<p style="text-align: center;"><img src="Ex_6_14.png" style="border: 1px solid black;" height="142" width="987" /></p>
<p><b>6.15 </b>Comptar el nombre de <strong>clients</strong> que tenen el <strong>codi postal nul</strong>.</p>
<p style="text-align: center;"><img src="Ex_6_15.png" style="border: 1px solid black;" /></p>
<p><b>6.16 </b>Comptar el número de vegades que l'article <strong>L76104</strong> entra en les línies de factura, i el número total d'unitats venudes d'aquest article. Només us fa falta la taula LINIA_FAC.</p>
<p style="text-align: center;"><img src="Ex_6_16.png" style="border: 1px solid black;" /></p>
<p><b>6.17 </b>Traure la <strong>mitjana</strong> del <strong>stock</strong> dels articles.</p>
<p style="text-align: center;"><img src="Ex_6_17.png" style="border: 1px solid black;" height="70" width="282" /></p>
<p><strong>6.18</strong> Modificar l'anterior per a<strong> tenir en compte els valors nuls, com si foren 0</strong>. Us vindrà bé la funció <strong>COALESCE</strong> que converteix els nuls del primer paràmetre al valor donat com a segon paràmetre (si és diferent de nul, deixa igual el valor). Per tant l'heu d'utilitzar d'aquesta manera: <strong>COALESCE(stock,0)</strong></p>
<p style="text-align: center;"><img src="Ex_6_18.png" style="border: 1px solid black;" height="67" width="280" /></p>
<p><strong>6.19</strong> Comptar <strong>quantes factures</strong> té el client <strong>375</strong></p>
<p style="text-align: center;"><strong><img src="Ex_6_19.png" style="border: 1px solid black;" /></strong></p>
<p><b>6.20 </b>Calcular el <strong>descompte màxim</strong>, el <strong>mínim</strong> i el descompte <strong>mitjà</strong> de les <strong>factures</strong>.</p>
<p style="text-align: center;"><img src="Ex_6_20.png" style="border: 1px solid black;" /></p>
<p><strong>6.21</strong> Comptar el número de pobles de cada província (és suficient traure el codi de la província i el número de pobles).</p>
<p style="text-align: center;"><img src="Ex_6_21.png" style="border: 1px solid black;" /></p>
<p><b>6.22 </b>Comptar el nombre de clients en cada poble i codi postal.</p>
<p style="text-align: center;"><img src="Ex_6_22.png" style="border: 1px solid black;" height="537" width="284" /></p>
<p style="text-align: center;">Un total de <strong>45 files</strong></p>
<p><b>6.23 </b>Comptar el número de factures de cada venedor a cada client.</p>
<p style="text-align: center;"><img src="Ex_6_23.png" style="border: 1px solid black;" height="297" width="316" /></p>
<p style="text-align: center;">Un total de <strong>96 files</strong></p>
<p style="text-align: center;">D'aquestes 96 files, relativament poque tenen un valor diferent de 1 en el número de factures: la fila 29 (455, 30, 2) o la fila 34 (5, 342, 3)</p>
<p><b>6.24 </b>Comptar el número de factures de cada trimestre. Per a poder traure el trimestre i agrupar per ell (ens val el número de trimestre, que va del 1 al 4), podem utilitzar la funció <strong>TO_CHAR(data,'Q')</strong>.</p>
<p style="text-align: center;"><img style="border: 1px solid black;" src="Ex_6_24.png" /></p>
<p style="text-align: center;">No apareix ordenat, i vol dir que en el trimestre 2 hi ha 25 factures, en el trimestre 4 hi ha 35, en el trimestre 3 hi ha 33 i en el trimestre 1 hi ha 22</p>
<p><b>6.25 </b>Calcular quantes vegades s'ha venut un article, la suma d'unitats venudes, la quantitat màxima i la quantitat mínima.</p>
<p style="text-align: center;"><img src="Ex_6_25.png" style="border: 1px solid black;" /></p>
<p style="text-align: center;">Un total de <strong>399 files</strong></p>
<p><b>6.26 </b>Comptar el número d'articles de cada categoria i el preu mitjà.</p>
<p style="text-align: center;"><img src="Ex_6_26.png" style="border: 1px solid black;" height="237" width="449" /></p>
<p><b>6.27</b> Calcular el total de cada factura, sense aplicar descomptes ni IVA. Només ens farà falta la taula <strong>LINIES_FAC</strong>, i consistirà en agrupar per cada <strong>num_f</strong> per a calcular la suma del <strong>preu</strong> multiplicat per la <strong>quantitat</strong>.</p>
<p style="text-align: center;"><img src="Ex_6_27.png" style="border: 1px solid black;" /></p>
<p style="text-align: center;">Un total de <strong>105 files</strong></p>
<p><b>6.28 </b>Calcular la mitjana de quantitats demanades d'aquells articles que s'han demanat més de dues vegades. Observeu que la taula que ens fa falta és LINIA_FAC, i que la condició (en el HAVING) és sobre el número de vegades que entra l'article en una linia de factura, però el resultat que s'ha de mostrar és la mitjana de la quantitat.</p>
<p style="text-align: center;"><img src="Ex_6_28.png" style="border: 1px solid black;" height="572" width="387" /></p>
<p><b>6.29</b> Traure els pobles que tenen entre 3 i 7 clients. Traure només el codi del poble i aquest número</p>
<p style="text-align: center;"><img src="Ex_6_29.png" style="border: 1px solid black;" height="91" width="190" /></p>
<p><b><b>6.30</b> </b>Traure les categories que tenen més d'un article "car" (de més de 100 €). Observeu que també ens eixirà la categoria NULL, és a dir, apareixerà com una categoria aquells articles que no estan catalogats.</p>
<p style="text-align: center;"><img src="Ex_6_30.png" style="border: 1px solid black;" height="115" width="252" /></p>
<p><b><b>6.31</b> </b>Traure els clients que tenen més d'una factura, amb el número de factures.</p>
<p style="text-align: center;"><img src="Ex_6_31.png" style="border: 1px solid black;" height="296" width="188" /></p>
<p style="text-align: center;">Un total de <strong>33 files</strong></p>
<p><b><b><b>6.32</b></b> </b>Modificar l'anterior per a traure els clients que tenen més d'una factura en el primer trimestre.</p>
<p style="text-align: center;"><img src="Ex_6_32.png" style="border: 1px solid black;" /></p>
<p><b><b><b>6.33</b></b> </b>Calcular el total de cada factura d'aquelles factures que tenen 10 o més línies de factura, sense aplicar descomptes ni IVA (com la consulta <strong>6.26</strong>), i també aplicant el descompte que consta en la línia de factura (no el descompte de tota la factura). Tindrem el problema que el valor NULL és especial, i en operar amb qualsevol altre valor donarà NULL. En aquest cas clarament l'hem de considerar com un descompte 0. Podeu utilitzar una funció que substitueix els valors nuls trobats en el primer paràmetre, pel segon paràmetre d'aquesta manera: <strong>COALESCE(dte,0)</strong></p>
<p style="text-align: center;"><img src="Ex_6_33.png" style="border: 1px solid black;" height="258" width="319" /></p>
<p><b>6.34 </b>Traure tots els clients ordenats per codi de població, i dins d'aquestos per codi postal.</p>
<p style="text-align: center;"><img src="Ex_6_34.png" style="border: 1px solid black;" /></p>
<p style="text-align: center;">Un total de <strong>49 files</strong></p>
<p><b>6.35 </b>Traure tots els articles ordenats per la categoria, dins d'aquest pel stock, i dins d'aquest per preu (de forma descendent)</p>
<p style="text-align: center;"><img src="Ex_6_35.png" style="border: 1px solid black;" /></p>
<p style="text-align: center;">Un total de <strong>812 files</strong></p>
<p><b>6.36 </b>Traure els resultats de la consulta <strong>6.33</strong> ordenats pel total de la factura quan ja s'ha aplicat el descompte, de forma descendent.</p>
<p style="text-align: center;"><img src="Ex_6_36.png" style="border: 1px solid black;" height="259" width="305" /></p>
<p><b>6.37 </b>Traure tots els articles ordenats per la diferència entre el stock i el stock mínim de forma descendent. Com que en moltes ocasions el stock o el stock mínim és nul, hem de considerar en aquestos casos com 0. Per tant hem de tornar a utilitzar la funció <strong>COALESCE(stock,0)</strong> (i també per al stock mínim).</p>
<p style="text-align: center;"><img src="Ex_6_37.png" style="border: 1px solid black;" /></p>
<p style="text-align: center;">Un total de <strong>812 files</strong></p>
<p><b>6.38 </b>Traure els codis de venedor amb el número de factures venudes en el segon semestre de 2015, ordenades per aquest número de forma descendent</p>
<p style="text-align: center;"><img src="Ex_6_38.png" style="border: 1px solid black;" /></p>
<p><b>6.39 </b>Traure els venedors que han venut alguna cosa el mes de gener de 2015.</p>
<p style="text-align: center;"><img src="Ex_6_39.png" style="border: 1px solid black;" /></p>
<p><b>6.40 </b>Traure els diferents tipus d'IVA que s'han aplicat a les factures de cada venedor, també durant el mes de gener de 2015</p>
<p style="text-align: center;"><img src="Ex_6_40.png" style="border: 1px solid black;" /></p>
<p><strong>6.41</strong> Traure els diferents caps de venedors (eviteu que aparega el valor nul)</p>
<p style="text-align: center;"><img src="Ex_6_41.png" style="border: 1px solid black;" /></p>
<p><b>6.42 </b>Traure els diferents descomptes que s'han aplicat als articles, el codi dels quals comença per <strong>SAT</strong>. Traure tant el codi d'article com el descompte.</p>
<p style="text-align: center;"><img src="Ex_6_42.png" style="border: 1px solid black;" /></p>
<p><strong>6.43</strong> Comptar en quantes poblacions tenim clients</p>
<p style="text-align: center;"><img src="Ex_6_43.png" style="border: 1px solid black;" /></p>
<p><b>6.44 </b>Traure tota la informació dels dos articles més cars.</p>
<p style="text-align: center;"><img src="Ex_6_44.png" style="border: 1px solid black;" /></p>
<p><b>6.45 </b>Traure el codi de les tres ciutats amb més clients</p>
<p style="text-align: center;"><img src="Ex_6_45.png" style="border: 1px solid black;" /></p>
<p><strong>6.46</strong> Traure el venedor que ha venut menys factures</p>
<p style="text-align: center;"><img src="Ex_6_46.png" style="border: 1px solid black;" /></p>
<p><b>6.47 </b>Traure les tres factures més cares (sense comptar els descomptes)</p>
<p style="text-align: center;"><img src="Ex_6_47.png" style="border: 1px solid black;" height="116" width="205" /></p>
<p><strong>6.48</strong> Modificar l'anterior per a traure totes les factures, excepte les 3 més cares.</p>
<p style="text-align: center;"><img src="Ex_6_48.png" style="border: 1px solid black;" /></p>
<p style="text-align: center;">Un total de <strong>102 files</strong></p>
<p align="justify"><b>6.49 </b>Crear una taula anomenada <strong>ARTICLE_999x</strong>, on 999 han de ser les 3 últimes xifres del DNI, i x la lletra del teu NIF, que siga una còpia de la taula ARTICLE, però substituint els valors nuls de <strong>stock</strong> i <strong>stock_min</strong> per zeros.</p>
<p style="text-align: center;" align="justify">El resultat ha de ser la creació de la taula. Si consulteu el seu contingut ha de ser el següent:</p>
<p style="text-align: center;" align="justify"><img src="Ex_6_49.png" style="border: 1px solid black;" height="537" width="811" /></p>
<p style="text-align: center;" align="justify">Untotal de <strong>812 files</strong></p>
<p align="justify"><strong>6.50</strong> Utilitzar la taula anterior per a traure el stock màxim, el mínim i la mitjana de stocks. Observeu que si utilitzàrem la taula ARTICLE, els resultats no serien els mateixos (excepte el màxim), sobretot la mitjana, ja que els valors nuls no entrarien en els càlculs d'aquesta mitjana.</p>
<p style="text-align: center;" align="justify"><img src="Ex_6_50.png" style="border: 1px solid black;" /></p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="19_ordre_amb_qu_sexecuta_una_sentncia_sql.html" class="prev"><span><span>&laquo; </span>Anterior</span></a>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Llicenciat sota la </span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Llicència Creative Commons Reconeixement NoComercial CompartirIgual 3.0</a></p>
</div>
</div>
</div>
</div>
</body></html>