<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ca" xml:lang="ca" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>3.2.8.3 Tipus de dades | Bases de Dades </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="ca" />
<meta name="author" content="Àlvar Serrano Calduch" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" />
<meta name="generator" content="eXeLearning 2.6 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site" id="exe-node-78"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Omet navegació</a></p>
<div id="header" ><div id="headerContent">Bases de Dades</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Tema 6: SQL -  DDL i consultes d'actualització (part III)</a></li>
   <li><a href="31_introducci.html" class="no-ch">3.1 Introducció</a></li>
   <li class="current-page-parent"><a href="32_ddl.html" class="current-page-parent daddy">3.2 DDL</a>
   <ul>
      <li><a href="321_tipus_de_dades.html" class="no-ch">3.2.1 Tipus de dades</a></li>
      <li><a href="322_create_table.html" class="daddy">3.2.2 CREATE TABLE</a>
      <ul class="other-section">
         <li><a href="exercicis.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="323_restriccions_constraint.html" class="daddy">3.2.3 Restriccions (Constraint)</a>
      <ul class="other-section">
         <li><a href="exercicis0.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="324_alter_table.html" class="daddy">3.2.4 ALTER TABLE</a>
      <ul class="other-section">
         <li><a href="exercicis1.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="325_drop_table.html" class="no-ch">3.2.5 DROP TABLE</a></li>
      <li><a href="326_ndex.html" class="daddy">3.2.6 Índex</a>
      <ul class="other-section">
         <li><a href="exercicis2.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="327_vistes.html" class="daddy">3.2.7 Vistes</a>
      <ul class="other-section">
         <li><a href="exercicis3.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li class="current-page-parent"><a href="328_creaci_daltres_objectes_seqncies_dominis_i_tipus.html" class="current-page-parent daddy">3.2.8. Creació d'altres objectes: seqüències, dominis i tipus.</a>
      <ul>
         <li><a href="3281_seqncies.html" class="no-ch">3.2.8.1 Seqüències</a></li>
         <li><a href="3282_dominis.html" class="no-ch">3.2.8.2 Dominis</a></li>
         <li id="active"><a href="3283_tipus_de_dades.html" class="active no-ch">3.2.8.3 Tipus de dades</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="33_consultes_dactualitzaci.html" class="daddy">3.3 Consultes d'actualització</a>
   <ul class="other-section">
      <li><a href="331_insert.html" class="daddy">3.3.1 INSERT</a>
      <ul class="other-section">
         <li><a href="exercicis4.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="332_delete.html" class="daddy">3.3.2 DELETE</a>
      <ul class="other-section">
         <li><a href="exercicis5.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="333_update.html" class="daddy">3.3.3 UPDATE</a>
      <ul class="other-section">
         <li><a href="exercicis6.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="exercicis_de_tot_el_tema.html" class="no-ch">Exercicis de tot el tema</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="3282_dominis.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="33_consultes_dactualitzaci.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">3.2.8.3 Tipus de dades</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id68">
<div class="iDevice emphasis0">
<div id="ta68_1" class="block iDevice_content">
<p> </p>
<p>Ja havíem comentat que PosgreSQL és molt versàtil, i permet a l'usuari crear tipus de dades personals.</p>
<p>Tres són les maneres de crear un tipus de dades: compost, enumerat i extern.</p>
<ul>
<li style="list-style-type: none">
<ul>
<li>El <b> compost</b> és com un registre, on s'especifiquen els <span style="font-style: italic;">camps</span> i els <span style="font-style: italic;">tipus</span>.</li>
</ul>
</li>
</ul>
<p></p>
<ul>
<li style="list-style-type: none">
<ul>
<li><b>Enumenat</b>: posarem els possibles <span style="font-style: italic;">valors</span> entre parèntesis.</li>
</ul>
</li>
</ul>
<p></p>
<ul>
<li>L'<b>extern</b> és molt més complet i complex que permet crear un nou tipus base, amb una estructura interna i amb funcions, normalment creades en C, d'entrada (per a introduir la dada) i eixida (per a representar-la), d'anàlisi, ... Aquest tipus s'escapa dels objectius d'aquest curs</li>
</ul>
<p> </p>
</div>
</div>
</div>
<div class="iDevice_wrapper FreeTextIdevice" id="id69">
<div class="iDevice emphasis0">
<div id="ta69_1" class="block iDevice_content">
<p class="titolet">Compost</p>
<p>Posarem entre parèntesi el nom dels camps i el tipus que formaran part d'aquest tipus compost. Per exemple, sobre la Base de Dades <strong>proves</strong>:</p>
<p class="codiSQL">CREATE TYPE num_complex AS (a float4, b float4);</p>
<p>que ens serviria per a representar números complexes. Si us dóna error perquè ja existieix el tipus (perquè l'ha creat un company/a), senzillament esborreu-lo abans i ho torneu a provar</p>
<blockquote>
<p align="center"></p>
</blockquote>
<p>Un altre exemple (no cal fer-lo, és il·lustratiu només):</p>
<p class="codiSQL">CREATE TYPE lat AS (<br />h char(1),<br />g numeric(2,0),<br />m numeric(2,0),<br />s numeric(2,0));</p>
<p>per a representar la latitud, encara que podríem aprofitar els dominis creats en el punt anterior, i ens eixirà millor (aquest sí que el podeu fer):</p>
<p class="codiSQL">CREATE TYPE lat AS (<br />h hemi_lat,<br />g graus_lat,<br />m min_seg,<br />s min_seg);</p>
<p>i el tipus <span style="font-weight: bold;">lat</span> haurà de respectar les restriccions de cada domini dels quatre camps.</p>
<p>Ara podríem definir una taula</p>
<p class="codiSQL">CREATE TABLE POBLACIONS3 (<br />nom VARCHAR(50) CONSTRAINT cp_pob3 PRIMARY KEY,<br />latitud lat,<br />comarca varchar(50));</p>
<p>D'aquesta manera queda molt compacte.</p>
<p>Per exemple, aquesta introducció de dades donarà un error, ja que l'hemisferi no és correcte:</p>
<p class="codiSQL">INSERT INTO POBLACIONS3<br />VALUES ('Castelló','(<span style="color: #ff0000;">K</span>,39,59,10)','Plana Alta');</p>
<p>En canvi aquesta funcionarà perfectament:</p>
<p class="codiSQL">INSERT INTO POBLACIONS3<br />VALUES ('Castelló','(N,39,59,10)','Plana Alta');</p>
<p>Per a accedir als camps dels tipus compostos, bé ja definits, bé definits per nosaltres, haurem de posar el nom de la columna seguida d'un punt i seguit del nom del camp. Però en les sentències SQL se'ns presenta un problema: que aquesta sintaxi serveix per a posar també el nom de la taula seguit del nom de la columna. Així per exemple ens donarà error la següent sentència, en la que volem traure el nom de la població, la latitud i si està en l'hemisferi nord o sud:</p>
<p class="codiSQL"><span style="color: #ff0000;">SELECT nom, latitud, latitud.h FROM POBLACIONS3;</span></p>
<p>L'error el dóna perquè en <span style="font-weight: bold;">latitud.h </span>espera que latitud siga una taula i h una columna. La manera d'esquivar aquest error és posar entre parèntesis la columna:</p>
<p class="codiSQL">SELECT nom, latitud, (latitud).h FROM POBLACIONS3;</p>
<p>En el tema següent, el de programació en <span style="font-weight: bold;">PL/pgSQL</span> veurem que allà no caldrà posar els parèntesis, perquè no hi haurà la confusió de taula.columna</p>
<p> </p>
</div>
</div>
</div>
<div class="iDevice_wrapper FreeTextIdevice" id="id74">
<div class="iDevice emphasis0">
<div id="ta74_1" class="block iDevice_content">
<p class="titolet">Enumerat</p>
<p>El tipus enumerat és un conjunt de dades <span style="font-style: italic;">estàtiques</span> definides en el moment de la creació del tipus, amb un ordre també predefinit. Està disponible des de la versió <b>8.3</b> de <span style="font-weight: bold;">PostgreSQL</span><span style="font-weight: bold;"></span>.</p>
<p>Ací tenim un exemple:</p>
<p class="codiSQL">CREATE TYPE d_set AS ENUM ('dilluns','dimarts','dimecres','dijous','divendres','dissabte','diumenge');</p>
<p>Posteriorment el podrem utilitzar, per exemple, en la definició d'una taula:</p>
<p class="codiSQL">CREATE TABLE HORARI (<br /> cod_pr NUMERIC(5) PRIMARY KEY,<br /> d_tut d_set,<br /> h_tut NUMERIC(4,2));</p>
<p>Ara el podem utilitzar. Haurem de tenir en compte que els valors són únicament els definits. I s'ha de respectar majúscules i minuscules.</p>
<p class="codiSQL">INSERT INTO HORARI VALUES (1,'dimarts',10);</p>
<p>En canvi, aquesta donaria error:</p>
<p class="codiSQL"><span style="color: #ff0000;">INSERT INTO HORARI VALUES (2,'Dimecres',12);</span></p>
<p>ja que el nom de la setmana comença en majúscula.</p>
<p>Introduïm algunes dades més</p>
<p class="codiSQL">INSERT INTO HORARI VALUES (2, 'dimecres',12) , (3,'dilluns',9) , (4,'divendres',11);</p>
<p>Podem comprovar com l'ordre predefint és el del moment de la creació del tipus:</p>
<p class="codiSQL">SELECT * FROM HORARI ORDER BY d_tut;</p>
<p>I com també es pot comprovar en aquesta sentència:</p>
<p class="codiSQL">SELECT * FROM HORARI WHERE d_tut &gt; 'dimarts';</p>
<p>on només eixiran les files corresponents al dimecres i al divendres (files 2 i 4).</p>
<p></p>
<p>Per últim, anem a esborrar els objectes que hem creat, per a no interferir amb els companys:</p>
<p class="codiSQL">DROP TABLE POBLACIONS2 , POBLACIONS3 , HORARI ;</p>
<p class="codiSQL">DROP TYPE num_complex , lat , d_set ;</p>
<p class="codiSQL">DROP DOMAIN hemi_lat , graus_lat , min_seg ;</p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="3282_dominis.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="33_consultes_dactualitzaci.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Llicenciat sota la </span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Llicència Creative Commons Reconeixement NoComercial CompartirIgual 3.0</a></p>
</div>
</div>
</div>
</div>
</body></html>