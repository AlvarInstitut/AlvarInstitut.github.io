<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ca" xml:lang="ca" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>3.2.8.2 Dominis | Bases de Dades </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="ca" />
<meta name="author" content="Àlvar Serrano Calduch" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" />
<meta name="generator" content="eXeLearning 2.6 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site" id="exe-node-77"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Omet navegació</a></p>
<div id="header" ><div id="headerContent">Bases de Dades</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Tema 6: SQL -  DDL i consultes d'actualització (part III)</a></li>
   <li><a href="31_introducci.html" class="no-ch">3.1 Introducció</a></li>
   <li class="current-page-parent"><a href="32_ddl.html" class="current-page-parent daddy">3.2 DDL</a>
   <ul>
      <li><a href="321_tipus_de_dades.html" class="no-ch">3.2.1 Tipus de dades</a></li>
      <li><a href="322_create_table.html" class="daddy">3.2.2 CREATE TABLE</a>
      <ul class="other-section">
         <li><a href="exercicis.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="323_restriccions_constraint.html" class="daddy">3.2.3 Restriccions (Constraint)</a>
      <ul class="other-section">
         <li><a href="exercicis0.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="324_alter_table.html" class="daddy">3.2.4 ALTER TABLE</a>
      <ul class="other-section">
         <li><a href="exercicis1.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="325_drop_table.html" class="no-ch">3.2.5 DROP TABLE</a></li>
      <li><a href="326_ndex.html" class="daddy">3.2.6 Índex</a>
      <ul class="other-section">
         <li><a href="exercicis2.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="327_vistes.html" class="daddy">3.2.7 Vistes</a>
      <ul class="other-section">
         <li><a href="exercicis3.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li class="current-page-parent"><a href="328_creaci_daltres_objectes_seqncies_dominis_i_tipus.html" class="current-page-parent daddy">3.2.8. Creació d'altres objectes: seqüències, dominis i tipus.</a>
      <ul>
         <li><a href="3281_seqncies.html" class="no-ch">3.2.8.1 Seqüències</a></li>
         <li id="active"><a href="3282_dominis.html" class="active no-ch">3.2.8.2 Dominis</a></li>
         <li><a href="3283_tipus_de_dades.html" class="no-ch">3.2.8.3 Tipus de dades</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="33_consultes_dactualitzaci.html" class="daddy">3.3 Consultes d'actualització</a>
   <ul class="other-section">
      <li><a href="331_insert.html" class="daddy">3.3.1 INSERT</a>
      <ul class="other-section">
         <li><a href="exercicis4.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="332_delete.html" class="daddy">3.3.2 DELETE</a>
      <ul class="other-section">
         <li><a href="exercicis5.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="333_update.html" class="daddy">3.3.3 UPDATE</a>
      <ul class="other-section">
         <li><a href="exercicis6.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="exercicis_de_tot_el_tema.html" class="no-ch">Exercicis de tot el tema</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="3281_seqncies.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="3283_tipus_de_dades.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">3.2.8.2 Dominis</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id67">
<div class="iDevice emphasis0">
<div id="ta67_1" class="block iDevice_content">
<p> </p>
<p>Els dominis són els conjunts de valors que pot agafar un determinat camp. Habitualment es posa senzillament un tipus de dades. Però el model relacional teòric és més restrictiu, i els dominis encara podrien ser subconjunts d'aquestos tipus de dades.</p>
<p>Normalment aquestos subconjunts es realitzen per mig dels <b><i>check</i></b>, que permeten una regla de validació (una condició) per a donar les dades com a bones (per exemple, un sou sempre és positiu, per tant, a banda de fer que siga numèric podríem obligar a que fóra positiu).</p>
<p>PostgreSQL permet definir dominis, que seran d'un determinat tipus base, d'una grandària determinada (opcional), amb un valor per defecte (opcional) i fins i tot amb una clàusula <b><i>check</i></b>. A partir d'aquest moment, un o més d'un camp els podrem definir d'aquest domini (amb l'avantatge que canviant el domini canviem el tipus de tots els camps que el tenen).</p>
<p>Anem a veure alguns exemples que es poden realitzar sobre l'usuari <b>proves</b>.</p>
<p class="codiSQL">CREATE DOMAIN sou AS numeric(7,2)<br /> CHECK (VALUE &gt; 0);</p>
<p>Si us dóna error perquè ja existia el domini, senzillament esborreu el domini anterior i ho torneu a provar</p>
<p>Ara podríem definir la taula:</p>
<p class="codiSQL">CREATE TABLE EMPLEAT5<br /> ( cod_e varchar(5) primary key,<br />   nom_e varchar(50),<br />   salari sou);</p>
<p>Si intentem introduir la dada del sou malament (per exemple posant-lo negatiu) veurem que dóna error.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="T6_3_2_8_2_1.png" height="553" width="908" /></p>
<p> </p>
<p>Un altre exemple, que farem sobre la Base de Dades <strong>proves</strong>, encara que és un exemple basat en les taules que teníem en <strong>geo</strong>.</p>
<p>En la taula de <strong>POBLACIONS</strong> tenim les coordenades (<b>latitud</b> i <b>longitud</b>). Podríem intentar fer uns dominis per a marcar l'<b>hemisferi</b> (N S per a latitud, i E W per a longitud), els <b>graus de latitud</b> (-90º a 90º), <b>graus de longitud</b> (-180º a 180º) en longitud, per als <b>minuts</b> (0' a 59') , <b>segons</b> (0” a 59”). Centrem-nos en la latitud:</p>
<div class="codi">CREATE DOMAIN hemi_lat AS char(1) <br />
<blockquote>CHECK (VALUE IN ('N','S'));</blockquote>
<br /> CREATE DOMAIN graus_lat AS numeric(2)<br />
<blockquote>CHECK (VALUE BETWEEN 0 AND 90);</blockquote>
<br /> CREATE DOMAIN min_seg AS numeric(2)<br />
<blockquote>CHECK (VALUE BETWEEN 0 AND 59);</blockquote>
</div>
<p>Ara podríem definir una alternativa a la taula de POBLACIONS:</p>
<p class="codiSQL">CREATE TABLE POBLACIONS2 <br /> ( nom VARCHAR(50) CONSTRAINT cp_pob2 PRIMARY KEY,<br />   lat_h hemi_lat,<br />   lat_g graus_lat,<br />   lat_m min_seg,<br />   lat_s min_seg);</p>
<p>i comprovaríem que les latituds s'han d'introduir correctament. Si posem per exemple els minuts malament, dóna error</p>
<p class="codiSQL">INSERT INTO POBLACIONS2<br />VALUES('Illes Columbretes','N',39,<span style="color: #ff0000;">73</span>,57);</p>
<p align="center"><img src="T6_3_2_8_2_2.png" /></p>
<p>Però no hi ha problema si les dades són correctes.</p>
<p class="codiSQL">INSERT INTO POBLACIONS2<br />VALUES('Illes Columbretes','N',39,53,57);</p>
<p align="center"><img src="T6_3_2_8_2_3.png" height="553" width="908" /></p>
<p> </p>
<p>Per a esborrar un domini, utilitzarem DROP DOMAIN.</p>
<p class="codiSQL">DROP DOMAIN sou;</p>
<p>Si algun camp està definit amb el domini que esborrem, donarà error. Si esborràrem amb l'opció CASCADE, s'esborrarien els camps de les taules amb aquest domini. Per a deixar que els companys/es puguen treballar també, esborrem tot el que hem creat:</p>
<p class="codiSQL">DROP TABLE EMPLEAT5;</p>
<p class="codiSQL">DROP DOMAIN sou;</p>
<p>Encara no esborrem els dominis <strong>hemi_lat</strong>, <strong>graus_lat</strong> i <strong>min_seg</strong>, perquè els utilitzarem en la següent pregunta.</p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="3281_seqncies.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="3283_tipus_de_dades.html" class="next"><span>Següent<span> &raquo;</span></span></a>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Llicenciat sota la </span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Llicència Creative Commons Reconeixement NoComercial CompartirIgual 3.0</a></p>
</div>
</div>
</div>
</div>
</body></html>