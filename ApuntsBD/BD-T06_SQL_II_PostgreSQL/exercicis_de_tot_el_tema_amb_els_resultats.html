<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ca" xml:lang="ca" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Exercicis de tot el tema, amb els resultats | Bases de Dades </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="ca" />
<meta name="author" content="Àlvar Serrano Calduch" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-nd/2.5/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site" id="exe-node-49"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Omet navegació</a></p>
<div id="header" ><div id="headerContent">Bases de Dades</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Tema 6: SQL -  Consultes avançades (part II)</a></li>
   <li><a href="21_introducci.html" class="no-ch">2.1 Introducció</a></li>
   <li><a href="22_combinacions_de_taules.html" class="daddy">2.2 Combinacions de taules</a>
   <ul class="other-section">
      <li><a href="221_producte_cartesi.html" class="no-ch">2.2.1 Producte cartesià</a></li>
      <li><a href="222_combinaci_interna.html" class="daddy">2.2.2 Combinació interna</a>
      <ul class="other-section">
         <li><a href="exercicis.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
      <li><a href="223_combinaci_externa.html" class="daddy">2.2.3 Combinació externa</a>
      <ul class="other-section">
         <li><a href="exercicis0.html" class="no-ch">Exercicis</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="23_subconsultes.html" class="daddy">2.3 Subconsultes</a>
   <ul class="other-section">
      <li><a href="exercicis1.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li><a href="24_consultes_doperacions_de_conjunts.html" class="daddy">2.4 Consultes d'operacions de conjunts</a>
   <ul class="other-section">
      <li><a href="exercicis2.html" class="no-ch">Exercicis</a></li>
   </ul>
   </li>
   <li id="active"><a href="exercicis_de_tot_el_tema_amb_els_resultats.html" class="active no-ch">Exercicis de tot el tema, amb els resultats</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="exercicis2.html" class="prev"><span><span>&laquo; </span>Anterior</span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">Exercicis de tot el tema, amb els resultats</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id50">
<div class="iDevice emphasis0">
<div id="ta50_85" class="block iDevice_content">
<p><b>6.51 </b>Traure el nom dels clients amb el número de factura i la data (individuals, sense agrupar res) que té cada client. Trau el resultat ordenat per client, i dins d'aquest per data de la factura</p>
<p style="text-align: center;"><img src="Ex_6_51.png" style="border: 1px solid black;" height="301" width="635" /></p>
<p style="text-align: center;">Un total de <strong>105 files</strong></p>
<p><b><b>6.5</b>2 </b>Traure el nom del soci, amb el codi i la descripció de cada article que ha demanat. Ordena per nom del soci i codi de l'article.</p>
<p><img src="Ex_6_52.png" style="border: 1px solid black; display: block; margin-left: auto; margin-right: auto;" height="324" width="707" /></p>
<p style="text-align: center;">Un total de <strong>541 files</strong></p>
<p><b><b>6.5</b>3</b> Modificar l'anterior per a que no es repetesquen els resultats.</p>
<p style="text-align: center;"><img style="border: 1px solid black;" src="Ex_6_53.png" height="329" width="708" /></p>
<p style="text-align: center;">Un total de <strong><strong>532 files</strong></strong></p>
<p style="text-align: center;">Observa com ara no es repeteix la fila 10 i 11, i abans sí</p>
<p><b><b>6.5</b>4</b> Traure el nom dels clients amb la quantitat de factures que tenen, ordenades per aquest número de major a menor</p>
<p style="text-align: center;"><img style="border: 1px solid black;" src="Ex_6_54.png" height="302" width="561" /></p>
<p style="text-align: center;">Un total de <strong>40 files</strong></p>
<p><b><b>6.5</b>5</b> Traure el número de factura, data, codi de client, total de la factura (amb l'àlies IMPORT) i total de la factura aplicant descomptes d'article (amb àlies DESCOMPTE_1), com en la consulta<strong> 6.33</strong>, però sense el límit de les 10 línies de factura. Ordena per número de factura.</p>
<p style="text-align: center;"><img src="Ex_6_55.png" style="border: 1px solid black;" /></p>
<p style="text-align: center;">Un total de <strong>105 files</strong></p>
<p><b><b>6.5</b>6 </b>Modificar l'anterior per a aplicar també el descompte de la factura (amb l'àlies DESCOMPTE_2)</p>
<p style="text-align: center;"><img src="Ex_6_56.png" style="border: 1px solid black;" height="302" width="651" /></p>
<p style="text-align: center;">Un total de <strong>105 files</strong></p>
<p><b><b>6.5</b>7</b> Traure el codi i nom d'aquells venedors que supervisen algú (consten com a cap). Traure també el número de supervisats de cadascun d'aquestos supervisors.</p>
<p style="text-align: center;"><img src="Ex_6_57.png" style="border: 1px solid black;" height="136" width="369" /> </p>
<p><b><b><b><b>6.5</b>8</b></b></b> Traure el codi i descripció dels articles juntament amb el número de vegades que s'ha venut, el total d'unitats venudes i la mitjana d'unitats venudes per factura. Ordenar pel número total d'unitats venudes de forma descendent, i dins d'aquesta per codi d'article de forma ascendent.</p>
<p style="text-align: center;"><img src="Ex_6_58.png" style="border: 1px solid black;" /></p>
<p style="text-align: center;">Un total de <strong>399 files</strong></p>
<p><b><b>6.5</b>9</b> Traure el codi i la descripció de les categories, amb la quantitat d'articles venuts de cada categoria, d'aquelles categories de les quals se n'han venut més de 100 unitats. Ordenar per aquest número de forma descendent.</p>
<p style="text-align: center;"><img src="Ex_6_59.png" style="border: 1px solid black;" height="162" width="443" /></p>
<p></p>
</div>
</div>
</div>
<div class="iDevice_wrapper FreeTextIdevice" id="id51">
<div class="iDevice emphasis0">
<div id="ta51_85" class="block iDevice_content">
<p><b><b>6.6</b>0 </b>Traure el codi i el nom dels clients que no tenen cap factura.</p>
<p style="text-align: center;"><img src="Ex_6_60.png" style="border: 1px solid black;" height="223" width="428" /></p>
<p align="justify"><b><b><b>6.6</b></b>1 </b>Traure el codi, descripció i total d'unitats venudes de tots els articles, fins i tot d'aquells que no s'ha venut res.</p>
<p style="margin-left: 30px;"><span style="text-decoration: underline;"><b>Nota</b></span></p>
<p style="margin-left: 30px;">Per a deixar-lo més bonic, com que la suma de valors nuls no és 0 sinó nul, per a que ens aparegue el valor 0 podem utilitzar la funció COALESCE(<i>valor</i>,0), que si el valor és nul torna un 0.</p>
<p style="margin-left: 30px; text-align: center;"><img style="border: 1px solid black;" src="Ex_6_61.png" /></p>
<p style="margin-left: 30px; text-align: center;">Un total de <strong>812 files</strong></p>
<p align="justify"><b><b><b>6.62</b></b> </b>Traure el nom de tots els pobles i el número de clients en cas que en tinguen. Ordena per número de clients de forma descendent.</p>
<p style="text-align: center;" align="justify"><img src="Ex_6_62.png" style="border: 1px solid black;" height="538" width="343" /></p>
<p style="text-align: center;" align="justify">Un total de <strong>1663 files</strong></p>
<p align="justify"><b><b><b>6.6</b></b>3</b> Traure el codi i la descripció de les categories, amb el número d'articles de cada categoria i el número total d'unitats venudes de cada categoria, d'aquelles categories de les quals tenim més de 15 articles, i ordenat per número d'articles de forma descendent. Aquesta sentència ja és prou complicada. Concretament haureu de tenir en compte que:</p>
<ul>
<li>Voldrem traure el número d'articles de cada categoria, però potser alguns articles no s'han venut, i per tant no apareixeran en la taula LINIA_FAC.</li>
<li>I també tenim el problema que, com ens fa falta la taula LINIA_FAC, un article venut en més d'una factura apareixerà més d'una vegada. Si comptem de forma normal, el comptaríem més d'una vegada cada article. Per tant voldrem comptar els diferents articles de cada categoria.</li>
</ul>
<p style="text-align: center;"><img src="Ex_6_63.png" style="border: 1px solid black;" /></p>
</div>
</div>
</div>
<div class="iDevice_wrapper FreeTextIdevice" id="id56">
<div class="iDevice emphasis0">
<div id="ta56_85" class="block iDevice_content">
<p><strong>6.64</strong> Traure el número màxim de factures fetes a un client</p>
<p style="text-align: center;"><img src="Ex_6_64.png" style="border: 1px solid black;" height="67" width="246" /></p>
<p><strong>6.65</strong> Traure el l'import que suposa la factura més cara i l'import que suposa la més barata (sense considerar ni descomptes ni IVA)</p>
<p style="text-align: center;"><img style="border: 1px solid black;" src="Ex_6_65.png" height="68" width="242" /></p>
<p><strong>6.66</strong> Traure el número de factures més alt que s'ha venut per venedor en cada trimestre (no traurem qui és el venedor, que seria encara més complicat). Per a poder agrupar per trimestre, ens farà falta la funció <strong>TO_CHAR</strong><strong>(data,'Q')</strong>, que trau el número de trimestre. El pas previ és calcular el número de factures de cada venedor i en cada trimestre. Després, amb la informació anterior, voldrem calcular el màxim de cada trimestre.</p>
<p style="text-align: center;"><img src="Ex_6_66.png" style="border: 1px solid black;" height="140" width="134" /></p>
<p><strong>6.67</strong> Traure els articles més cars que la mitjana. Tragueu-los ordenats per la categoria, i després per codi d'article.</p>
<p style="text-align: center;"><img src="Ex_6_67.png" style="border: 1px solid black;" height="416" width="794" /></p>
<p style="text-align: center;">Un total de <strong>164 files</strong></p>
<p><strong>6.68</strong> Modificar l'anterior per a traure els articles més cars que la mitjana de la seua categoria. Tragueu-los ordenats per la categoria</p>
<p style="text-align: center;"><img src="Ex_6_68.png" style="border: 1px solid black;" /></p>
<p style="text-align: center;">Un total de <strong>75 files</strong></p>
<p style="text-align: center;">És un resultat molt similar a l'anterior, però observeu que ara no estan els productes de les files 5, 14, 15, ...</p>
<p><strong>6.69</strong> Traure els pobles on tenim clients però no tenim venedors. Ha de ser per mig de subconsultes (en plural). Ordeneu per codi del poble.</p>
<p style="text-align: center;"><img src="Ex_6_69.png" style="border: 1px solid black;" height="572" width="390" /></p>
<p><strong>6.70</strong> Traure els pobles on tenim més venedors que clients. Traure el codi del poble, el nom i el número de venedors. Ordena per nom del poble.</p>
<p style="text-align: center;"><img src="Ex_6_70.png" style="border: 1px solid black;" height="233" width="345" /></p>
<p><strong>6.71 </strong>Traure l'import de la factura més cara de cada trimestre. La informació prèvia és la factura amb la data i l'import. A partir d'ahí haurem de calcular el màxim de l'import per a cada trimestre (no caldrà traure quina factura és).</p>
<p style="text-align: center;"><img src="Ex_6_71.png" style="border: 1px solid black;" height="138" width="188" /></p>
<p><strong>6.72</strong> Traure el nom del venedor, el número de factures que ha venut i el percentatge que suposa sobre el total. Podria ser que en el moment de calcular el percentatge, el número resultant s'haja de convertir a numèric per a que dóne bé el resultat, ja que en fer una operació amb enters, el resultat serà enter. Aleshores hauríem d'obligar a que el número tinga decimals (<b>::NUMERIC</b>). I la funció d'arrodonir és <b>ROUND</b>. Ordeneu pel nom.</p>
<p style="text-align: center;"><img src="Ex_6_72.png" style="border: 1px solid black;" height="287" width="464" /></p>
<p><strong><strong>6.73</strong></strong> Traure tota la informació (amb l'import) de la factura més cara. Ha de ser per mig de subconsultes. Mireu que segurament hi haurà 2 subconsultes. En la més interna calculem l'import de les factures. En l'altra calculem el màxim. I en la consulta principal, busquem la factura que coincideix amb aquest màxim.</p>
<p style="text-align: center;"><img src="Ex_6_73.png" style="border: 1px solid black;" height="65" width="338" /></p>
<p><strong>6.74 (voluntari)</strong> Obtenir el venedor que ha venut més unitats de cada categoria, sense considerar en la categoria el valor nul. Aquesta consulta la podríem considerar ja com molt avançada.</p>
<p style="text-align: center;"><img src="Ex_6_74.png" style="border: 1px solid black;" height="212" width="653" /></p>
</div>
</div>
</div>
<div class="iDevice_wrapper FreeTextIdevice" id="id57">
<div class="iDevice emphasis0">
<div id="ta57_85" class="block iDevice_content">
<p><b>6.75 </b>Traure el nom de tots els clients i venedors implicats en alguna venda del primer trimestre de 2015. Intentar traure en una segona columna el text <strong>Venedor</strong> per als venedors, i <strong>Client</strong> per als clients. Ordenat pel nom.</p>
<p style="text-align: center;"><img src="Ex_6_75.png" style="border: 1px solid black;" height="643" width="468" /></p>
<p><strong>6.76a</strong> Traure per mig de sentències d'operacions de conjunts els pobles on tenim algun venedor o algun client. No volem resultats repetits, i ho volem ordenat pel nom del poble.</p>
<p style="text-align: center;"><img src="Ex_6_76a.png" style="border: 1px solid black;" height="297" width="204" /></p>
<p style="text-align: center;">Un total de <strong>31 files</strong></p>
<p><strong>6.76b</strong> Modificar l'anterior per a traure els pobles on tenim al mateix temps venedors i clients</p>
<p style="text-align: center;"><img src="Ex_6_76b.png" style="border: 1px solid black;" height="69" width="205" /></p>
<p><strong>6.76c</strong> Modificar l'anterior per a traure els pobles on tenim venedors però no tenim clients</p>
<p style="text-align: center;"><img src="Ex_6_76c.png" style="border: 1px solid black;" height="236" width="256" /></p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="exercicis2.html" class="prev"><span><span>&laquo; </span>Anterior</span></a>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-nd">
<p><span>Llicenciat sota la </span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/2.5/">Llicència Creative Commons Reconeixement NoComercial SenseObraDerivada 2.5</a></p>
</div>
</div>
</div>
</div>
</body></html>