<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ca" xml:lang="ca" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Exercicis | Accés a Dades </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="ca" />
<meta name="author" content="Àlvar Serrano Calduch" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-sa/2.5/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
</head>
<body class="exe-web-site" id="exe-node-15"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Omet navegació</a></p>
<div id="header" ><div id="headerContent">Accés a Dades</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Tema 4: Bases de Dades Relacionals</a></li>
   <li><a href="1__les_bases_de_dades_relacionals.html" class="no-ch">1 - Les Bases de Dades Relacionals</a></li>
   <li><a href="2__el_desfasament_objecterelacional.html" class="no-ch">2 - El desfasament Objecte-Relacional</a></li>
   <li><a href="3__connexi_a_les_bd_connectors.html" class="daddy">3 - Connexió a les BD: Connectors</a>
   <ul class="other-section">
      <li><a href="31__odbc.html" class="no-ch">3.1 - ODBC</a></li>
      <li><a href="32__jdbc.html" class="no-ch">3.2 - JDBC</a></li>
   </ul>
   </li>
   <li><a href="4__perspectiva_de_desenvolupament_de_bases_de_dades_en_eclipse.html" class="no-ch">4 - Perspectiva de Desenvolupament de Bases de Dades en Eclipse</a></li>
   <li><a href="5__iniciaci_a_lapi_jdbc.html" class="daddy">5 - Iniciació a l'API JDBC</a>
   <ul class="other-section">
      <li><a href="51__crrega_de_controladors.html" class="no-ch">5.1 - Càrrega de controladors</a></li>
      <li><a href="52__establiment_de_la_connexi.html" class="no-ch">5.2 - Establiment de la connexió</a></li>
      <li><a href="53__peticions_bsiques.html" class="no-ch">5.3 - Peticions bàsiques</a></li>
      <li><a href="54__exemple.html" class="no-ch">5.4 - Exemple</a></li>
   </ul>
   </li>
   <li><a href="6__jdbc_avanat.html" class="daddy">6 - JDBC avançat</a>
   <ul class="other-section">
      <li><a href="61__accs_a_les_meta_dades.html" class="no-ch">6.1 - Accés a les Meta Dades</a></li>
      <li><a href="62__resultsets_que_poden_avanar_cap_avant_i_cap_arrere.html" class="no-ch">6.2 - ResultSets que poden avançar cap avant i cap arrere</a></li>
      <li><a href="63__tractament_derrors_en_aplicacions_jdbc.html" class="no-ch">6.3 - Tractament d'errors en aplicacions JDBC</a></li>
      <li><a href="64__transaccions.html" class="no-ch">6.4 - Transaccions</a></li>
      <li><a href="65__millora_de_rendiment.html" class="no-ch">6.5 - Millora de rendiment</a></li>
   </ul>
   </li>
   <li id="active"><a href="exercicis.html" class="active no-ch">Exercicis</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="65__millora_de_rendiment.html" class="prev"><span><span>&laquo; </span>Anterior</span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">Exercicis</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id25">
<div class="iDevice emphasis0">
<div id="ta25_85" class="block iDevice_content">
<p>Els següents exercicis, posa'ls tots en un paquet del projecte <strong>Tema4</strong> anomenat <strong>E</strong><strong>xercicis</strong></p>
</div>
</div>
</div>
<div class="iDevice_wrapper activityIdevice em_iDevice em_iDevice_activity" id="id26">
<div class="iDevice emphasis1" >
<img alt="" class="iDevice_icon" src="icon_activity.gif" /><h2 class="iDeviceTitle">Exercici 4_1</h2><div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta26_42_2" class="block iDevice_content">
<div id="intro" class="box generalbox boxaligncenter">
<div class="no-overflow">
<p>Crea una classe executable (amb main) anomenada <strong>CreaTaulesRuta</strong> que cree les taules necessàries per a guardar les dades de les rutes en una Base de Dades SQLite anomenada <strong>Rutes.sqlite</strong>.</p>
<p>Han de ser 2 taules:</p>
<ul>
<li><strong>RUTES</strong>: que contindrà tota la informació del conjunt de la ruta. La clau principal s'anomenarà <strong>num_r</strong> (entera). També guardarà el nom de la ruta (<strong>nom_r</strong>), desnivell <strong></strong>(<strong>desn</strong>) i desnivell acumulat (<strong>desn_ac</strong>). Els tipus d'aquestos tres camps últims seran de text, enter i enter respectivament.</li>
<li><strong>PUNTS</strong>: que contindrà la informació dels punts individuals de les rutes. Contindrà els camps <strong>num_r</strong> (número de ruta: enter) , <strong>num_p</strong> (número de punt: enter), <strong>nom_p</strong> (nom del punt: text) , <strong>latitud</strong> (número real) i <strong>longitud</strong> (número real). La clau principal serà la combinació <strong>num_r + num_p</strong> . Tindrà una <strong>clau externa</strong> (<strong>num_r</strong>) que apuntarà a la clau principal de <strong>RUTES</strong>.</li>
</ul>
<p>Adjunta tot el projecte, i també la Base de Dades <strong>Rutes.sqlite </strong>(normalment estarà dins del projecte)</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="iDevice_wrapper activityIdevice em_iDevice em_iDevice_activity" id="id30">
<div class="iDevice emphasis1" >
<img alt="" class="iDevice_icon" src="icon_activity.gif" /><h2 class="iDeviceTitle">Exercici 4_2</h2><div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta30_41_2" class="block iDevice_content">
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta27_43_2" class="block iDevice_content">
<div id="intro" class="box generalbox boxaligncenter">
<div class="no-overflow">
<p>Crea una altra classe executable anomenada <strong>PassarRutesObjSQLite</strong> que passe les dades del fitxer <strong>Rutes.obj </strong>a les taules de <strong>Rutes.sqlite</strong>.</p>
<p>Per a major comoditat copiat el fitxer <strong>Rutes.obj</strong> que vam fer al projecte <strong>Tema3 </strong>dins d'aquest projecte, a més de les classes <strong>Coordenades.java</strong>, <strong>PuntGeo.java</strong> i <strong>Ruta.java</strong> dins del paquet. Si el paquet s'anomena igual en els dos projectes (jo us havia suggerit <strong>Exercicis</strong>) no hauria d'haver cap problema.</p>
<p>Concretament en el trasvassament d'informació:</p>
<ul>
<li>Per a cada <strong>ruta</strong> s'ha de considerar el <strong>número de ruta</strong>, que s'anirà incrementant, i a més serà la <strong>clau principal</strong>. La primera ruta ha de ser la número 1. A banda han d'anar la resta de camps.</li>
<li>Per a cada <strong>punt</strong> s'ha de guardar el <strong>número de ruta</strong> i el <strong>número de punt</strong> (s'aniràincrementant des de 1 per a cada ruta). A banda han d'anar la resta de camps.</li>
<li>T'aconselle vivament que abans d'executar les sentències SQL d'inserció, les tragues per pantalla, per veure si la sintaxi és correcta. Quan totes siguen correctes, pots substituir l'eixida per l'execució de les sentències.</li>
<li>Per últim intenta capturar els errors per a traure missatges comprensibles.</li>
</ul>
<p>Adjunta tot el projecte, i també la Base de Dades <strong>Rutes.sqlite</strong>, que normalment estarà situada dins del projecte</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="iDevice_wrapper activityIdevice em_iDevice em_iDevice_activity" id="id31">
<div class="iDevice emphasis1" >
<img alt="" class="iDevice_icon" src="icon_activity.gif" /><h2 class="iDeviceTitle">Exercici 4_3</h2><div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta31_41_2" class="block iDevice_content">
<p>Crea un classe anomenada <strong>Vis_Rutes_SQLite</strong>, que mostre les rutes amb un aspecte similar a l'<strong>Exercici 3_4</strong>, però accedint ara a les dades guardades en <strong>Rutes.sqlite</strong>:</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="T4_Ex3_1.png" /></p>
<p>Podríem mantenir la connexió fins que s'aprete el botó d'<strong>Eixir</strong>, que és quan la tancaríem.</p>
<p>Ací teniu l'esquelet dels programes.</p>
<p class="codi">import java.awt.BorderLayout;<br />import java.awt.FlowLayout;<br />import java.awt.event.ActionEvent;<br />import java.awt.event.ActionListener;<br />import java.sql.Connection;<br />import java.util.ArrayList;<br /><br />import javax.swing.JButton;<br />import javax.swing.JComboBox;<br />import javax.swing.JFrame;<br />import javax.swing.JLabel;<br />import javax.swing.JPanel;<br />import javax.swing.JTextArea;<br /><br /><br />public class Vis_Rutes_SQLite_Pantalla extends JFrame implements ActionListener{<br />    <br />    JComboBox combo;<br />    JButton eixir = new JButton("Eixir");<br />    JTextArea area = new JTextArea();<br />    Connection con;<br />    <br />    public void iniciar(){<br />        // sentències per a fer la connexió<br />        <br />        <br />        this.setBounds(100, 100, 450, 300);<br />        this.setLayout(new BorderLayout());<br />        <br />        JPanel panell1 = new JPanel(new FlowLayout());<br />        JPanel panell2 = new JPanel(new BorderLayout());<br />        this.add(panell1,BorderLayout.NORTH);<br />        this.add(panell2,BorderLayout.CENTER);<br />        <br />        ArrayList&lt;String&gt; llista_rutes = new ArrayList&lt;String&gt;();<br />        // sentències per a omplir l'ArrayList amb el nom de les rutes<br />        <br />        <br />        combo = new JComboBox(llista_rutes.toArray());<br />        <br />        panell1.add(combo);<br />        panell1.add(eixir);<br />        <br />        panell2.add(new JLabel("LLista de punts de la ruta:"),BorderLayout.NORTH);<br />        panell2.add(area,BorderLayout.CENTER);<br />        <br />        this.setVisible(true);<br />        combo.addActionListener(this);<br />        eixir.addActionListener(this);<br />        <br />        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);<br />        <br />    }<br /><br />    @Override<br />    public void actionPerformed(ActionEvent e) {<br />        if (e.getSource() == combo){<br />            //accions quan s'ha seleccionat un element del combobox, i que han de consistir en omplir el JTextArea<br />            <br />        }<br /><br />        if (e.getSource() == eixir){<br />            //accions quan s'ha apretat el botó d'eixir<br />            <br />        }<br />    }<br />}</p>
<p class="codi">public class Vis_Rutes_SQLite {<br /><br />    public static void main(String[] args) {<br />        Vis_Rutes_SQLite_Pantalla finestra = new Vis_Rutes_SQLite_Pantalla();<br />        finestra.iniciar();<br />    }<br />}</p>
</div>
</div>
</div>
</div>
</div>
<div class="iDevice_wrapper activityIdevice em_iDevice em_iDevice_activity" id="id29">
<div class="iDevice emphasis1" >
<img alt="" class="iDevice_icon" src="icon_activity.gif" /><h2 class="iDeviceTitle">Exercici 4_4</h2><div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta29_45_2" class="block iDevice_content">
<div id="intro" class="box generalbox boxaligncenter">
<div class="no-overflow">
<p>En aquest exercici anem a practicar la creació d'una classe que encapsule pràcticament tot el tractament de la Base de Dades, per a fer transparent el desfasament Objecte-Relacional. Per tant aquesta classe ha de ser capaç de llegir de les taules convertint a objectes, i també guardar la informació dels objectes en les taules. S'anomenarà <strong>GestionarRutesBD</strong><strong>.</strong></p>
<p>En un paquet nou del mateix projecte, anomenat <strong>util.bd</strong> haureu de fer la classe <strong>GestionarRutesBD</strong>, que és la que encapsularà tot. Internament només tindrà una propietat, la de connexió. Tindrà els següents mètodes:</p>
<ul>
<li>Constructor <strong>public GestionarRutesBD()</strong>: establirà la connexió amb la Base de Dades <strong>Rutes.sqlite</strong> (per comoditat en el directori del projecte). Si no existeixen les taules <strong>RUTES </strong>i <strong>PUNTS</strong> les haurà de crear (podeu utilitzar la sentència <strong>CREATE TABLE IF NOT EXISTS</strong> ...)</li>
<li><strong>public void close()</strong>: tancarà la connexió.</li>
<li><strong>public void inserir(Ruta r)</strong>: Inserirà en la BD les dades corresponents a la ruta passada per paràmetre (inicialment s'aconsella únicament "imprimir" les sentències, per veure si són correctes). El <strong>num_r</strong> ha de ser el posterior a l'última existent, per exemple amb la consulta <strong>SELECT MAX(num_r) FROM RUTES</strong></li>
<li><strong>public Ruta buscar(int i)</strong>: torna la ruta amb el número passat com a paràmetre.</li>
<li><strong><strong>public ArrayList&lt;Ruta&gt; llistat()</strong>: </strong>torna un ArrayList de Ruta amb totes les rutes de la Base de Dades.</li>
<li><strong>public void esborrar(int i)</strong>: esborra la ruta amb el número passat com a paràmetre (recordeu que els punts de la ruta també s'han d'esborrar)</li>
</ul>
<p>Per a provar-lo podeu incorporar l'executable (que té main) <strong>UtilitzarRutesBD</strong>. Hauríeu de comentar les línies que no s'utilitzen en cada moment. Per exemple, si ja heu aconseguit inserir la ruta, i continueu provant el programa per als mètodes <strong>buscar()</strong> i <strong>llistat()</strong>, comenteu la línia <strong>gRutes.inserir(r);</strong> per a no inserir-la més vegades.</p>
<p class="codi">public class UtilitzarRutesBD {<br /><br />    public static void main(String[] args) throws FileNotFoundException, IOException, ClassNotFoundException {<br />        // Creació del gestionador<br />        GestionarRutesBD gRutes = new GestionarRutesBD();<br />        <br />        <br />        // Inserció d'una nova Ruta<br />        String[] noms = {"Les Useres","Les Torrocelles","Lloma Bernat","Xodos (Molí)","El Marinet","Sant Joan"};<br />        double[] latituds = {40.158126,40.196046,40.219210,40.248003,40.250977,40.251221};<br />        double[] longituds = {-0.166962,-0.227611,-0.263560,-0.296690,-0.316947,-0.354052};<br /><br />        Ruta r = new Ruta();<br />        r.setNom("Pelegrins de Les Useres");<br />        r.setDesnivell(896);<br />        r.setDesnivellAcumulat(1738);<br />        for (int i=0;i&lt;6;i++){<br />            r.addPunt(noms[i], latituds[i], longituds[i]);<br />        }<br />        <br />        gRutes.inserir(r);<br /><br />        // Llistat de totes les rutes<br />        ArrayList&lt;Ruta&gt; llista = gRutes.llistat();<br />        for (int i=0;i&lt;llista.size();i++){<br />            llista.get(i).mostraRuta();<br />        }<br />        <br />        // Buscar una ruta determinada<br />        gRutes.buscar(2).mostraRuta();<br />        <br />        gRutes.close();<br />    }<br />}</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="iDevice_wrapper activityIdevice em_iDevice em_iDevice_activity" id="id32">
<div class="iDevice emphasis1" >
<img alt="" class="iDevice_icon" src="icon_activity.gif" /><h2 class="iDeviceTitle">Exercici 4_5 (voluntari)</h2><div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta32_41_2" class="block iDevice_content">
<p>Crea el segünet mètode en la classe <strong>GestionarRutesBD</strong>:</p>
<p><strong>public void guardar(Ruta r)</strong></p>
<p>El que ha de fer aquest mètode és:</p>
<ul>
<li>Si no existeix la ruta, la inserirem</li>
<li>Si ja existeix la ruta, la modificarem. Heu de parar especial atenció als punts. Potser el més còmode siga esborrar els punts de la ruta i tornar a crear-los</li>
</ul>
<p>Considerarem que la ruta existeix si hi ha una amb el mateix nom.</p>
<p>Per a provar-lo, podeu utilitzar aquest programa principal.</p>
<p class="codi">import java.io.FileNotFoundException;<br />import java.io.IOException;<br />import java.util.ArrayList;<br /><br />import util.bd.GestionarRutesBD;<br />import util.bd.Ruta;<br />import util.bd.PuntGeo;<br /><br />public class UtilitzarRutesBD2{<br /><br />    public static void main(String[] args) throws FileNotFoundException, IOException, ClassNotFoundException {<br />        // Creació del gestionador<br />        GestionarRutesBD gRutes = new GestionarRutesBD();<br />        <br />        Ruta r = gRutes.buscar(1);<br />        r.mostraRuta();<br />        r.setDesnivellAcumulat(606);<br />        gRutes.guardar(r);<br />        <br />        r = gRutes.buscar(2);<br />        r.mostraRuta();<br />        r.getLlistaDePunts().add(0, new PuntGeo ("Plaça M.Agustina", 39.988507,-0.034533));<br />        gRutes.guardar(r);<br />        <br />        System.out.println("Després de modificar");<br />        r=gRutes.buscar(1);<br />        r.mostraRuta();<br />        r=gRutes.buscar(2);<br />        r.mostraRuta();<br />        <br />        gRutes.close();<br />    }<br />}</p>
</div>
</div>
</div>
</div>
</div>
<div class="iDevice_wrapper activityIdevice em_iDevice em_iDevice_activity" id="id41">
<div class="iDevice emphasis1" >
<img alt="" class="iDevice_icon" src="icon_activity.gif" /><h2 class="iDeviceTitle">Exercici 4_6 (voluntari)</h2><div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta41_44_2" class="block iDevice_content">
<p>Anem a fer molt més completa i atractiva l'aplicació gràfica de les rutes. Ens aprofitarem del construït en els exercicis 4.4 i 4.5, és a dir, la classe <strong>GestionarRutesBD</strong>, que encapsulava pràcticament l'accés a la BD, de manera que nosaltres obtenim (i guardem) objectes.</p>
<p>El programa mostrarà una ruta, i hi haurà també uns botons per anar a la primera, anterior, següent i última ruta. Hi ha també el botó de Tancar, que tancarà l'objecte GestionarRutesBD i eixirà del programa.</p>
<p>Per a omplir el JTable amb els punts, teniu un mètode que ho fa automàticament: <strong>plenarTaula()</strong>. Observeu quin és el seu paràmetre.</p>
<p>Aquest seria el seu aspecte:</p>
<p style="text-align: center;"><img src="T4_Ex6.png" alt="" width="461" height="593" /></p>
<p>Aquest seria el programa principal:</p>
<div class="codi">
<div>
<pre><code>public class Rutes_SQLite_Complet {

    public static void main(String[] args) {
         Rutes_SQLite_Complet_pantalla finestra = new Rutes_SQLite_Complet_pantalla();
         finestra.iniciar();
    }
}</code></pre>
</div>
</div>
<p>I aquest l'esquelet del programa que ho fa tot. Vosaltres heu d'implementar els 3 mètodes del final.</p>
<div class="codi">
<div>
<pre><code>import java.awt.FlowLayout;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;

import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.JTable;

import util.bd.PuntGeo;
import util.bd.Ruta;

public class Rutes_SQLite_Complet_pantalla extends JFrame implements ActionListener {

    private static final long serialVersionUID = 1L;
    ArrayList&lt;Ruta&gt; llista = new ArrayList&lt;Ruta&gt;();
    int numActual;
    Ruta rutaActual;
    
    JLabel etiqueta = new JLabel("");
    JLabel etNom = new JLabel("Ruta:");
    JTextField qNom = new JTextField(15);
    JLabel etDesn = new JLabel("Desnivell:");
    JTextField qDesn = new JTextField(5);
    JLabel etDesnAcum = new JLabel("Desnivell acumulat:");
    JTextField qDesnAcum = new JTextField(5);
    JLabel etPunts = new JLabel("Punts:");
    JTable punts = new JTable(1,3);
    JButton primer = new JButton(" &lt;&lt; ");
    JButton anterior = new JButton(" &lt; ");
    JButton seguent = new JButton(" &gt; ");
    JButton ultim = new JButton(" &gt;&gt; ");
    JButton tancar = new JButton("Tancar");

    // en iniciar posem un contenidor per als elements anteriors
    public void iniciar() {
        getContentPane().setLayout(new GridLayout(0,1));
        JPanel p_prin = new JPanel();
        p_prin.setLayout(new BoxLayout(p_prin, BoxLayout.Y_AXIS));
        // contenidor per als elements
        JPanel panell1 = new JPanel(new GridLayout(0,2));
        panell1.add(etNom);
        qNom.setEditable(false);
        panell1.add(qNom);
        panell1.add(etDesn);
        qDesn.setEditable(false);
        panell1.add(qDesn);
        panell1.add(etDesnAcum);
        qDesnAcum.setEditable(false);
        panell1.add(qDesnAcum);
        panell1.add(etPunts);

        JPanel panell2 = new JPanel(new GridLayout(0,1));
        punts.setEnabled(false);
        JScrollPane scroll = new JScrollPane(punts);
        panell2.add(scroll, null);

        JPanel panell5 = new JPanel(new FlowLayout());
        panell5.add(primer);
        panell5.add(anterior);
        panell5.add(seguent);
        panell5.add(ultim);

        JPanel panell6 = new JPanel(new FlowLayout());
        panell6.add(tancar);

        getContentPane().add(p_prin);
        p_prin.add(panell1);
        p_prin.add(panell2);
        p_prin.add(panell5);
        p_prin.add(panell6);
        
        setVisible(true);
        pack();
        primer.addActionListener(this);
        anterior.addActionListener(this);
        seguent.addActionListener(this);
        ultim.addActionListener(this);
        tancar.addActionListener(this);

        inicialitzar();
        VisRuta();
    }

    private void plenarTaula(ArrayList&lt;PuntGeo&gt; ll_punts){
        Object[][] ll= new Object[ll_punts.size()][3];
        for (int i=0;i&lt;ll_punts.size();i++){
            ll[i][0]=ll_punts.get(i).getNom();
            ll[i][1]=ll_punts.get(i).getLatitud();
            ll[i][2]=ll_punts.get(i).getLongitud();
        }
        String[] caps = {"Nom punt","Latitud","Longitud"};
        punts.setModel(new javax.swing.table.DefaultTableModel(ll,caps));
    }

    @Override
    public void actionPerformed(ActionEvent e) {
      
    }

    private void inicialitzar() {
      
    }
    
    private void VisRuta(){
       
    }    
}</code></pre>
</div>
</div>
<p></p>
</div>
</div>
</div>
</div>
</div>
<div class="iDevice_wrapper activityIdevice em_iDevice em_iDevice_activity" id="id102">
<div class="iDevice emphasis1" >
<img alt="" class="iDevice_icon" src="icon_activity.gif" /><h2 class="iDeviceTitle">Exercici 4_7 (ampliació - voluntari)</h2><div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta102_89_2" class="block iDevice_content">
<p>Modifica l'aplicació anterior per a que es puguen modificar, esborrar i inserir les rutes.</p>
<p style="text-align: center;"><img src="T4_Ex7_1.png" alt="" width="583" height="593" /></p>
<ul>
<li>S'haurien de posar més botons: <strong>Editar</strong>, <strong>Eliminar</strong> i <strong>Nova Ruta</strong>.</li>
<li>Estaria bé que en entrar a qualsevol de les opcions anteriors es desactivaren els botons de navegació, que desaparegueren els d'Editar, Eliminar i Nova Ruta, i que aparegueren els d'<strong>Acceptar</strong> i <strong>Cancel·lar</strong>.</li>
<li>En tots els casos, si es cancel·la no es fa cap acció, però s'ha de tornar a l'estat anterior (primera imatge)</li>
<li><strong>EDITAR</strong>:
<ul>
<li>S'han d'"activar" els controls per a poder modificar les dades.</li>
<li>En cas d'acceptar s'ha de fer la modificació a partir del contingut de tots els controls (no cal detectar quins s'han modificat)</li>
<li style="text-align: left;">En cas de cancel·lar, no es fa la modificació, i senzillament s'ha de tornar a visualitzar la ruta actual (com no s'ha fet cap canvi, apareixeran les dades anteriors)</li>
<li style="text-align: left;">Per a afegir nous punts, es podria posar un botó per a afegir una nova línia al JTable, i un altre per a llevar una línia</li>
</ul>
</li>
</ul>
<p style="text-align: left;"><img src="T4_Ex7_2.png" alt="" style="display: block; margin-left: auto; margin-right: auto;" width="583" height="593" /></p>
<ul>
<li><strong>ELIMINAR</strong>:
<ul>
<li>Si s'accepta, s'haurà d'esborrar la ruta, sinó tornar a visualitzar-la</li>
</ul>
</li>
</ul>
<p style="text-align: center;"><img src="T4_Ex7_3.png" alt="" width="583" height="593" /></p>
<ul>
<li><strong>INSERIR</strong>:
<ul>
<li>Haurà de mostrar tots els camps en blanc, i evidentment activats, per a poder introduir dades.</li>
<li>En cas d'acceptar s'ha d'introduir la nova ruta.</li>
<li>En cas de cancel·lar, estaria bé tornar a la que s'estava mostrant abans d'apretar el botó de nova ruta.</li>
<li style="text-align: left;">Per a introduir nous punts, es podria posar un botó per a afegir una nova línia al JTable, i un altre per a llevar una línia</li>
</ul>
</li>
</ul>
<p style="text-align: center;"><img src="T4_Ex7_4.png" alt="" width="583" height="593" /></p>
<p style="text-align: left;"><span style="text-decoration: underline;"><strong>Nota</strong></span></p>
<p style="text-align: left;">EL JTable de vegades és engorrós. Si s'està editant una casella, la informació no s'ha introduït encara, fins que no s'aprete enter, tab o amb el ratolí no s'aprete a algun altre lloc.Per a acabar la introducció de la informació que s'està editant, es podria executar el següent (per exemple quan s'ha apretat <strong>Acceptar</strong>):</p>
<p style="text-align: left;" class="codi">            if (punts.isEditing())<br />                punts.getCellEditor().stopCellEditing();</p>
<p style="text-align: left;">on <strong>punts</strong> seria al JTable.</p>
<p style="text-align: left;"></p>
<p style="text-align: left;">Aquest seria l'esquelet del programa, on hem posat 2 mètodes que poden anar bé per a activar i visualitzar uns botons o altres. I també activar els JTextField i el JTable.</p>
<div class="codi">
<div>
<pre><code>import java.awt.FlowLayout;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;

import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.JTable;

import util.bd.PuntGeo;
import util.bd.Ruta;
import util.bd.GestionarRutesBD;

public class Rutes_SQLite_Avancat_pantalla extends JFrame implements ActionListener {

	private static final long serialVersionUID = 1L;
	GestionarRutesBD gBD = new GestionarRutesBD();
	ArrayList&lt;Ruta&gt; llista = new ArrayList&lt;Ruta&gt;();
	int numActual;
	Ruta rutaActual;
	boolean actualitzant = false;
	String modificacio;

	JLabel etiqueta = new JLabel("");
	JLabel etNom = new JLabel("Ruta:");
	JTextField qNom = new JTextField(15);
	JLabel etDesn = new JLabel("Desnivell:");
	JTextField qDesn = new JTextField(5);
	JLabel etDesnAcum = new JLabel("Desnivell acumulat:");
	JTextField qDesnAcum = new JTextField(5);
	JLabel etPunts = new JLabel("Punts:");
	JTable punts = new JTable(1, 3);
	JButton primer = new JButton(" &lt;&lt; ");
	JButton anterior = new JButton(" &lt; ");
	JButton seguent = new JButton(" &gt; ");
	JButton ultim = new JButton(" &gt;&gt; ");
	JButton tancar = new JButton("Tancar");

	JButton editar = new JButton("Editar");
	JButton eliminar = new JButton("Eliminar");
	JButton nova = new JButton("Nova Ruta");

	JButton acceptar = new JButton("Acceptar");
	JButton cancelar = new JButton("Cancel·lar");
	JButton mesP = new JButton("+p");
	JButton menysP = new JButton("-p");

	// en iniciar posem un contenidor per als elements anteriors
	public void iniciar() throws ClassNotFoundException {
		Class.forName("org.sqlite.JDBC");
		getContentPane().setLayout(new GridLayout(0, 1));
		JPanel p_prin = new JPanel();
		p_prin.setLayout(new BoxLayout(p_prin, BoxLayout.Y_AXIS));
		// contenidor per als elements
		JPanel panell1 = new JPanel(new GridLayout(0, 2));
		panell1.add(etNom);
		qNom.setEditable(false);
		panell1.add(qNom);
		panell1.add(etDesn);
		qDesn.setEditable(false);
		panell1.add(qDesn);
		panell1.add(etDesnAcum);
		qDesnAcum.setEditable(false);
		panell1.add(qDesnAcum);
		panell1.add(etPunts);

		JPanel panell2 = new JPanel(new GridLayout(0, 1));
		punts.setEnabled(false);
		JScrollPane scroll = new JScrollPane(punts);
		panell2.add(scroll, null);

		JPanel panell5 = new JPanel(new FlowLayout());
		panell5.add(primer);
		panell5.add(anterior);
		panell5.add(seguent);
		panell5.add(ultim);
		panell5.add(editar);
		panell5.add(eliminar);
		panell5.add(nova);

		acceptar.setVisible(false);
		panell5.add(acceptar);
		cancelar.setVisible(false);
		panell5.add(cancelar);
		mesP.setVisible(false);
		panell5.add(mesP);
		menysP.setVisible(false);
		panell5.add(menysP);

		JPanel panell6 = new JPanel(new FlowLayout());
		panell6.add(tancar);

		getContentPane().add(p_prin);
		p_prin.add(panell1);
		p_prin.add(panell2);
		p_prin.add(panell5);
		p_prin.add(panell6);

		setVisible(true);
		ActivarAltres(true);
		pack();
		ActivarAltres(false);
		primer.addActionListener(this);
		anterior.addActionListener(this);
		seguent.addActionListener(this);
		ultim.addActionListener(this);
		tancar.addActionListener(this);

		editar.addActionListener(this);
		eliminar.addActionListener(this);
		nova.addActionListener(this);
		acceptar.addActionListener(this);
		cancelar.addActionListener(this);
		mesP.addActionListener(this);
		menysP.addActionListener(this);

		inicialitzar();
		VisRuta();
	}

	private void plenarTaula(ArrayList&lt;PuntGeo&gt; ll_punts) {
		Object[][] ll = new Object[ll_punts.size()][3];
		for (int i = 0; i &lt; ll_punts.size(); i++) {
			ll[i][0] = ll_punts.get(i).getNom();
			ll[i][1] = ll_punts.get(i).getLatitud();
			ll[i][2] = ll_punts.get(i).getLongitud();
		}
		String[] caps = { "Nom punt", "Latitud", "Longitud" };
		punts.setModel(new javax.swing.table.DefaultTableModel(ll, caps));
	}

	@Override
	public void actionPerformed(ActionEvent e) {

	}

	private void inicialitzar() {

	}

	private void VisRuta() {

	}

	private void ActivarAltres(boolean estat) {

	}

	private void ActivarQuadres(boolean estat) {

	}

}</code></pre>
</div>
</div>
<p style="text-align: left;">I aquest el programa principal:</p>
<div class="codi">
<div>
<pre><code>public class Rutes_SQLite_Avancat {

    public static void main(String[] args) throws ClassNotFoundException {
         Rutes_SQLite_Avancat_pantalla finestra = new Rutes_SQLite_Avancat_pantalla();
         finestra.iniciar();
    }
}</code></pre>
</div>
</div>
<p style="text-align: left;"></p>
</div>
</div>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="65__millora_de_rendiment.html" class="prev"><span><span>&laquo; </span>Anterior</span></a>
</div>
</div>
<div id="packageLicense" class="cc cc-by-sa">
<p><span>Llicenciat sota la </span> <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/">Llicència Creative Commons Reconeixement CompartirIgual 2.5</a></p>
</div>
</div>
</div>
</div>
</body></html>